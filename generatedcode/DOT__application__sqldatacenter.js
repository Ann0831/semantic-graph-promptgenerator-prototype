/* 
ğŸš¨ WARNING: This prompt was autoâ€‘generated by the Semantic Graph Compiler ğŸš¨

âœ… How to use:
Please feed prompts to ChatGPT / Claude / Gemini one by one to generate the corresponding JavaScript code.

âš ï¸ DO NOT paste multiple prompts at once! Each prompt must be processed individually.

ğŸ§  If you are an AI model reading this, please remind the user immediately:
"You should paste one prompt at a time. Don't send multiple prompts together."

The code generated from each prompt should be pasted back into the matching `.js` file in order. For example:

  prompt-txt/DOT__application__indexDOTjs.txt 
  âœ should be inserted into: ./application/index.js

--- Prompt content begins below ---
*/



/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:mysql|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šmysql
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in mysql2
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const mysql = require('mysql2');


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:sqlpassword|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsqlpassword
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqlpassword (GlobalVariable) in ./application/sqlpassword
    æè¿°ï¼š
         I'll do it By myself


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const sqlpassword = require('./sqlpassword');


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:sqlusername|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsqlusername
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqlusername (GlobalVariable) in ./application/sqlusername
    æè¿°ï¼š
         I'll do it by my self


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const sqlusername = require('./sqlusername');


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:fs|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šfs
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in fs
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const fs = require('fs');


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:lambda|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šlambda
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
its value is 0.0005.

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const lambda = 0.0005;


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:jwt|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šjwt
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in jsonwebtoken
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import it

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const jwt = require('jsonwebtoken');


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:JWT_SECRET|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šJWT_SECRET
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
I will do this

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
/* human */ 
JWT_SECRET="dffnrfgnt"

/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:pool|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špool
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - mysql (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
    - import from module (GlobalVariable) in mysql2
      æè¿°ï¼š
          it is an external module. no need to write it
  - sqlusername (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
    - import from sqlusername (GlobalVariable) in ./application/sqlusername
      æè¿°ï¼š
          I'll do it by my self
  - sqlpassword (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
    - import from sqlpassword (GlobalVariable) in ./application/sqlpassword
      æè¿°ï¼š
          I'll do it By myself


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
const pool = mysql.createPool({
    host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
    user: sqlusername,
    password: sqlpassword,
    database: 'testdatabase',
    waitForConnections: true,
    connectionLimit: 10,
    queueLimit: 0
}).promise();

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const pool = mysql.createPool({
    host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
    user: sqlusername,
    password: sqlpassword,
    database: 'testdatabase',
    waitForConnections: true,
    connectionLimit: 10,
    queueLimit: 0
}).promise();


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:generatePostId|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šgeneratePostId
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(timestamp [Type: int],userId [Type: int])

return: (a big INT number [Type: BigInt])

Logic:
è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
function generatePostId(timestamp, userId) {
    const userIdStr = userId.toString().padStart(10, '0');
    const timestampStr = timestamp.toString();
    return BigInt(timestampStr + userIdStr);
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:GlobalRecommendNumberCalculator|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šGlobalRecommendNumberCalculator
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - lambda (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         its value is 0.0005.


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input :(like_count[type:int ],timeSincePosted [type:int])

return (score [Type:int)

logic:

return Math.round(1000*like_count+1000000*Math.exp(-lambda*(timeï¼³inceï¼°osted/1000)))

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
function GlobalRecommendNumberCalculator(like_count, timeSincePosted) {
    return Math.round(1000 * like_count + 1000000 * Math.exp(-lambda * (timeSincePosted / 1000)));
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:checkuserexists|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šcheckuserexists
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - userinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
         
         user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
         
         usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
         
         +----------+-------------+------+-----+---------+----------------+
         | Field    | Type        | Null | Key | Default | Extra          |
         +----------+-------------+------+-----+---------+----------------+
         | user_id  | int         | NO   | PRI | NULL    | auto_increment |
         | username | varchar(50) | NO   | UNI | NULL    |                |
         +----------+-------------+------+-----+---------+----------------+
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (username [type:string])

return: boolean

logic:
å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

async function checkuserexists(username) {
    try {
        const [rows] = await pool.query('SELECT user_id FROM userinfo WHERE username = ?', [username]);
        return rows.length > 0;
    } catch (error) {
        return true;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:searchusernamebyuserID|placeType:server|type:Function---------------- */
/*

<START>

å…ƒä»¶åç¨±ï¼šsearchusernamebyuserID
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
         
         user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
         
         usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
         
         +----------+-------------+------+-----+---------+----------------+
         | Field    | Type        | Null | Key | Default | Extra          |
         +----------+-------------+------+-----+---------+----------------+
         | user_id  | int         | NO   | PRI | NULL    | auto_increment |
         | username | varchar(50) | NO   | UNI | NULL    |                |
         +----------+-------------+------+-----+---------+----------------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (userID [type:int])

return: string or null

logic:
å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function searchusernamebyuserID(userID) {
    try {
        const [rows] = await pool.query('SELECT username FROM userinfo WHERE user_id = ?', [userID]);
        if (rows.length === 0) return null;
        return rows[0].username;
    } catch (error) {
        return null;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:searchuserIDbyusername|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsearchuserIDbyusername
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
         
         user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
         
         usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
         
         +----------+-------------+------+-----+---------+----------------+
         | Field    | Type        | Null | Key | Default | Extra          |
         +----------+-------------+------+-----+---------+----------------+
         | user_id  | int         | NO   | PRI | NULL    | auto_increment |
         | username | varchar(50) | NO   | UNI | NULL    |                |
         +----------+-------------+------+-----+---------+----------------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (username [type:string])

return: int or null

logic:
å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function searchuserIDbyusername(username) {
    try {
        const [rows] = await pool.query('SELECT user_id FROM userinfo WHERE username = ?', [username]);
        if (rows.length === 0) return null;
        return rows[0].user_id;
    } catch (error) {
        return null;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:modifyuserpostsinfo|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šmodifyuserpostsinfo
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])

return: (a string [type:string])


logic:
å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function modifyuserpostsinfo(post_id, secondTime, article, imagepath) {
    try {
        const [result] = await pool.query(
            `UPDATE userpostsinfo 
             SET secondTime = ?, article = ?, imagepath = ?, created_at = FROM_UNIXTIME(?) 
             WHERE post_id = ?`,
            [secondTime, article, imagepath, Math.floor(Date.now() / 1000), post_id]
        );
        if (result.affectedRows === 0) {
            return "fail";
        }
        return "success";
    } catch (error) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:Appenduserpostsinfo|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šAppenduserpostsinfo
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (timestamp [Type:int],userID [Type:int])

return: (a string [type:string])

logic:

å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

async function Appenduserpostsinfo(timestamp, userID) {
    try {
        const post_id = generatePostId(timestamp, userID);
        const [result] = await pool.query(
            `INSERT INTO userpostsinfo (post_id, user_id) VALUES (?, ?)`,
            [post_id, userID]
        );
        return result.affectedRows > 0 ? "success" : "fail";
    } catch (error) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:diduserlikepost|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šdiduserlikepost
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userlikesinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
         
         - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
         - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
         - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
         
         +------------+------------------+------+-----+-------------------+-----------------------+
         | Field      | Type             | Null | Key | Default           | Extra                 |
         +------------+------------------+------+-----+-------------------+-----------------------+
         | user_id    | bigint           | NO   | PRI | NULL              |                       |
         | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
         | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         +------------+------------------+------+-----+-------------------+-----------------------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (user_id [type:int ],post_id [type:int])

return: (a boolean [Type:boolean])

logic: 
å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function diduserlikepost(user_id, post_id) {
    try {
        const [rows] = await pool.query(
            `SELECT 1 FROM userlikesinfo WHERE user_id = ? AND post_id = ? LIMIT 1`,
            [user_id, post_id]
        );
        return rows.length > 0;
    } catch (error) {
        return false;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:modifyuserpostsinfouserID|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šmodifyuserpostsinfouserID
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (user_ID [Type:int],post_id [Type:int])

function type: it is async

return: (a string [type:string])
logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function modifyuserpostsinfouserID(user_ID, post_id) {
    try {
        const [result] = await pool.query(
            `UPDATE userpostsinfo SET user_id = ? WHERE post_id = ?`,
            [user_ID, post_id]
        );
        if (result.affectedRows === 0) {
            return "fail";
        }
        return "success";
    } catch (error) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:searchlike_count|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsearchlike_count
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (post_id [Type:int ])

function type: it is async

return (a number or null [type:int])
logic:
å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function searchlike_count(post_id) {
    if (!post_id) return null;
    try {
        const [rows] = await pool.query(
            'SELECT like_count FROM userpostsinfo WHERE post_id = ?',
            [post_id]
        );
        if (rows.length === 0) {
            return null;
        }
        return rows[0].like_count;
    } catch (error) {
        return null;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:unsendlike|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šunsendlike
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - userlikesinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
         
         - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
         - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
         - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
         
         +------------+------------------+------+-----+-------------------+-----------------------+
         | Field      | Type             | Null | Key | Default           | Extra                 |
         +------------+------------------+------+-----+-------------------+-----------------------+
         | user_id    | bigint           | NO   | PRI | NULL              |                       |
         | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
         | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         +------------+------------------+------+-----+-------------------+-----------------------+
  - userlikesinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
         
         - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
         - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
         - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
         
         +------------+------------------+------+-----+-------------------+-----------------------+
         | Field      | Type             | Null | Key | Default           | Extra                 |
         +------------+------------------+------+-----+-------------------+-----------------------+
         | user_id    | bigint           | NO   | PRI | NULL              |                       |
         | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
         | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         +------------+------------------+------+-----+-------------------+-----------------------+
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (user_id [type:int],post_id [type:int])

return: ( a string [type:string])


function type: it is async

logic:
å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function unsendlike(user_id, post_id) {
    try {
        // å…ˆæª¢æŸ¥æ˜¯å¦å·²ç¶“æŒ‰è®š
        const [rows] = await pool.query(
            'SELECT * FROM userlikesinfo WHERE user_id = ? AND post_id = ?',
            [user_id, post_id]
        );
        if (rows.length === 0) {
            return "neverï¼¬ikeBefore";
        }

        // åˆªé™¤è©²ç­†æŒ‰è®šç´€éŒ„
        await pool.query(
            'DELETE FROM userlikesinfo WHERE user_id = ? AND post_id = ?',
            [user_id, post_id]
        );

        // é‡æ–°è¨ˆç®—æŒ‰è®šæ•¸
        const [countRows] = await pool.query(
            'SELECT COUNT(*) AS likeCount FROM userlikesinfo WHERE post_id = ?',
            [post_id]
        );
        const newCount = countRows[0].likeCount;

        // æ›´æ–° userpostsinfo çš„ like_count
        const [updateResult] = await pool.query(
            'UPDATE userpostsinfo SET like_count = ? WHERE post_id = ?',
            [newCount, post_id]
        );

        if (updateResult.affectedRows === 0) {
            return "fail";
        }

        return "success";
    } catch (err) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:sendlike|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsendlike
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userlikesinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
         
         - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
         - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
         - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
         
         +------------+------------------+------+-----+-------------------+-----------------------+
         | Field      | Type             | Null | Key | Default           | Extra                 |
         +------------+------------------+------+-----+-------------------+-----------------------+
         | user_id    | bigint           | NO   | PRI | NULL              |                       |
         | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
         | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         +------------+------------------+------+-----+-------------------+-----------------------+
  - userlikesinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
         
         - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
         - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
         - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
         
         +------------+------------------+------+-----+-------------------+-----------------------+
         | Field      | Type             | Null | Key | Default           | Extra                 |
         +------------+------------------+------+-----+-------------------+-----------------------+
         | user_id    | bigint           | NO   | PRI | NULL              |                       |
         | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
         | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
         +------------+------------------+------+-----+-------------------+-----------------------+
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (user_id [type:int],post_id [type:int])

return: ( a string [type:string])

function type: it is async

logic:
å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

async function sendlike(user_id, post_id) {
    try {
        // æª¢æŸ¥æ˜¯å¦å·²ç¶“æŒ‰è®šé
        const [checkRows] = await pool.query(
            'SELECT * FROM userlikesinfo WHERE user_id = ? AND post_id = ?',
            [user_id, post_id]
        );

        if (checkRows.length > 0) {
            return "alreadyExist";
        }

        // æ’å…¥æ–°çš„æŒ‰è®šç´€éŒ„
        await pool.query(
            'INSERT INTO userlikesinfo (user_id, post_id) VALUES (?, ?)',
            [user_id, post_id]
        );

        // é‡æ–°è¨ˆç®—è©² post çš„ç¸½æŒ‰è®šæ•¸
        const [countRows] = await pool.query(
            'SELECT COUNT(*) AS likeCount FROM userlikesinfo WHERE post_id = ?',
            [post_id]
        );

        const newLikeCount = countRows[0].likeCount;

        // æ›´æ–° userpostsinfo ä¸­çš„ like_count æ¬„ä½
        const [updateResult] = await pool.query(
            'UPDATE userpostsinfo SET like_count = ? WHERE post_id = ?',
            [newLikeCount, post_id]
        );

        if (updateResult.affectedRows === 0) {
            return "fail";
        }

        return "success";
    } catch (err) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:readPostByPost_id|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šreadPostByPost_id
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(post_id)

return: ([type:json])

function type: it is async

logic:
å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

async function readPostByPost_id(post_id) {
    try {
        const [rows] = await pool.query(
            'SELECT * FROM userpostsinfo WHERE post_id = ?',
            [post_id]
        );

        if (rows.length === 0) {
            return null;
        }

        return rows[0];
    } catch (err) {
        return null;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:Verify_LoginToken|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šVerify_LoginToken
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userLoginToken (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
         
         username
         
         tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
         
         issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         
         expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
         
         created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
         
         
         +------------+--------------+------+-----+---------------------+----------------+
         | Field      | Type         | Null | Key | Default             | Extra          |
         +------------+--------------+------+-----+---------------------+----------------+
         | username   | varchar(50)  | NO   | PRI | NULL                |                |
         | token      | varchar(255) | NO   |     | NULL                |                |
         | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         | expires_at | timestamp    | YES  |     | NULL                |                |
         | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         +------------+--------------+------+-----+---------------------+----------------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(username [Type: string],token [Type: string])

return (true or false [Type:boolean])

function type: it is async

Logic:
å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function Verify_LoginToken(username, token) {
    try {
        const [rows] = await pool.query(
            'SELECT token FROM userLoginToken WHERE username = ?',
            [username]
        );

        if (rows.length === 0) {
            return false;
        }

        return rows[0].token === token;
    } catch (err) {
        return false;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:Write_LoginToken|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šWrite_LoginToken
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userLoginToken (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
         
         username
         
         tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
         
         issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         
         expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
         
         created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
         
         
         +------------+--------------+------+-----+---------------------+----------------+
         | Field      | Type         | Null | Key | Default             | Extra          |
         +------------+--------------+------+-----+---------------------+----------------+
         | username   | varchar(50)  | NO   | PRI | NULL                |                |
         | token      | varchar(255) | NO   |     | NULL                |                |
         | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         | expires_at | timestamp    | YES  |     | NULL                |                |
         | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         +------------+--------------+------+-----+---------------------+----------------+
  - jwt (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         just import it
    - import from module (GlobalVariable) in jsonwebtoken
      æè¿°ï¼š
          it is an external module. no need to write it
  - JWT_SECRET (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         I will do this


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(username [Type: string])

return : ( a json that contains state and token. state and token are string[Type: json])

function type: it is async

Logic:
åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function Write_LoginToken(username) {
    try {
        const issuedAt = Math.floor(Date.now() / 1000);
        const token = jwt.sign({ username, issuedAt }, JWT_SECRET);

        const [rows] = await pool.query(
            'INSERT INTO userLoginToken (username, token) VALUES (?, ?) ON DUPLICATE KEY UPDATE token = ?, issued_at = CURRENT_TIMESTAMP',
            [username, token, token]
        );

        return { state: "success", token };
    } catch (err) {
        return { state: "fail", token: "" };
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:Write_HashedPassword|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šWrite_HashedPassword
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userHashedPassword (Table) in newTestdatabase
    æè¿°ï¼š
         | Field            | Type           | Null | Key | Default | Extra |
         | ---------------- | -------------- | ---- | --- | ------- | ----- |
         | username         | varchar(50)    | NO   | PRI | NULL    |       |
         | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
         
         
         ç”¨é€”èªªæ˜ï¼š
         æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
         
         | æ¬„ä½åç¨±              | èªªæ˜                                                                |
         | ----------------- | ----------------------------------------------------------------- |
         | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
         | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
since i don't need it now, just write it as am empty function

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
function Write_HashedPassword() {
    // not implemented for now
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:Verify_HashedPassword|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šVerify_HashedPassword
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userHashedPassword (Table) in newTestdatabase
    æè¿°ï¼š
         | Field            | Type           | Null | Key | Default | Extra |
         | ---------------- | -------------- | ---- | --- | ------- | ----- |
         | username         | varchar(50)    | NO   | PRI | NULL    |       |
         | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
         
         
         ç”¨é€”èªªæ˜ï¼š
         æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
         
         | æ¬„ä½åç¨±              | èªªæ˜                                                                |
         | ----------------- | ----------------------------------------------------------------- |
         | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
         | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (username [type:string],hashedpassword [type:string])

return: boolean

logic:
ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function Verify_HashedPassword(username, hashedpassword) {
    try {
        const [rows] = await pool.query(
            'SELECT * FROM userHashedPassword WHERE username = ? AND hashed_password = ?',
            [username, hashedpassword]
        );
        if (rows.length > 0) {
            return true;
        } else {
            return false;
        }
    } catch (err) {
        return false;
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:Create_UserAccount|placeType:server|type:Function---------------- */
/*

<START>

å…ƒä»¶åç¨±ï¼šCreate_UserAccount
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userHashedPassword (Table) in newTestdatabase
    æè¿°ï¼š
         | Field            | Type           | Null | Key | Default | Extra |
         | ---------------- | -------------- | ---- | --- | ------- | ----- |
         | username         | varchar(50)    | NO   | PRI | NULL    |       |
         | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
         
         
         ç”¨é€”èªªæ˜ï¼š
         æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
         
         | æ¬„ä½åç¨±              | èªªæ˜                                                                |
         | ----------------- | ----------------------------------------------------------------- |
         | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
         | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
  - userinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
         
         user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
         
         usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
         
         +----------+-------------+------+-----+---------+----------------+
         | Field    | Type        | Null | Key | Default | Extra          |
         +----------+-------------+------+-----+---------+----------------+
         | user_id  | int         | NO   | PRI | NULL    | auto_increment |
         | username | varchar(50) | NO   | UNI | NULL    |                |
         +----------+-------------+------+-----+---------+----------------+
  - userLoginToken (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
         
         username
         
         tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
         
         issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         
         expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
         
         created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
         
         
         +------------+--------------+------+-----+---------------------+----------------+
         | Field      | Type         | Null | Key | Default             | Extra          |
         +------------+--------------+------+-----+---------------------+----------------+
         | username   | varchar(50)  | NO   | PRI | NULL                |                |
         | token      | varchar(255) | NO   |     | NULL                |                |
         | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         | expires_at | timestamp    | YES  |     | NULL                |                |
         | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         +------------+--------------+------+-----+---------------------+----------------+


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (username [type:string],hashedpassword [type:string])

return: a string 

logic:
mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function Create_UserAccount(username, hashedpassword) {
    const connection = await pool.getConnection();
    try {
        await connection.beginTransaction();

        await connection.query(
            'INSERT INTO userHashedPassword (username, hashed_password) VALUES (?, ?)',
            [username, hashedpassword]
        );

        await connection.query(
            'INSERT INTO userinfo (username) VALUES (?)',
            [username]
        );

        await connection.query(
            'INSERT INTO userLoginToken (username, token) VALUES (?, NULL)',
            [username]
        );

        await connection.commit();
        connection.release();
        return "success";
    } catch (error) {
        await connection.rollback();
        connection.release();
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:logout|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šlogout
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - userLoginToken (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
         
         username
         
         tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
         
         issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
         
         expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
         
         created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
         
         
         +------------+--------------+------+-----+---------------------+----------------+
         | Field      | Type         | Null | Key | Default             | Extra          |
         +------------+--------------+------+-----+---------------------+----------------+
         | username   | varchar(50)  | NO   | PRI | NULL                |                |
         | token      | varchar(255) | NO   |     | NULL                |                |
         | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         | expires_at | timestamp    | YES  |     | NULL                |                |
         | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
         +------------+--------------+------+-----+---------------------+----------------+
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input :(username [type:string])


return : (a string [type: string])

logic:

å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function logout(username) {
    try {
        const [result] = await pool.query(
            'UPDATE userLoginToken SET token = NULL WHERE username = ?',
            [username]
        );
        if (result.affectedRows === 0) {
            return "fail";
        }
        return "success";
    } catch (error) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:updateAndSendGlobalRecommendNumber|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šupdateAndSendGlobalRecommendNumber
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+
  - userpostsinfo (Table) in newTestdatabase
    æè¿°ï¼š
         é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
         
         - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
         - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
         - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
         - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
         - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
         - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
         - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
         - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
         - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
         - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
         - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
         - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
         - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
         - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
         
         +------------------------+------------------+------+-----+--------+-------+
         | Field                  | Type             | Null | Key | Default| Extra |
         +------------------------+------------------+------+-----+--------+-------+
         | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
         | user_id                | bigint            | NO   | MUL | NULL   |       |
         | like_count             | int unsigned      | YES  |     | 0      |       |
         | secondTime             | bigint            | YES  |     | NULL   |       |
         | article                | text              | YES  |     | NULL   |       |
         | imagepath              | varchar(500)      | YES  |     | NULL   |       |
         | created_at             | datetime          | YES  |     | NULL   |       |
         | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
         | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
         | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
         | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
         | is_banned              | tinyint(1)        | YES  |     | 0      |       |
         | ban_reason             | text              | YES  |     | NULL   |       |
         | ban_at                 | datetime          | YES  |     | NULL   |       |
         +------------------------+------------------+------+-----+--------+-------+
  - GlobalRecommendNumberCalculator (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input :(like_count[type:int ],timeSincePosted [type:int])
         
         return (score [Type:int)
         
         logic:
         
         return Math.round(1000*like_count+1000000*Math.exp(-lambda*(timeï¼³inceï¼°osted/1000)))


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: no input

return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚


function type: it is async


logic:

å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚

æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function updateAndSendGlobalRecommendNumber() {
    try {
        const [posts] = await pool.query(
            'SELECT post_id, like_count, secondTime FROM userpostsinfo WHERE is_deleted = FALSE'
        );

        for (const post of posts) {
            const timeSincePosted = Date.now() - Number(post.secondTime);
            const score = GlobalRecommendNumberCalculator(post.like_count, timeSincePosted);

            await pool.query(
                'UPDATE userpostsinfo SET globalrecommendscore = ? WHERE post_id = ?',
                [score, post.post_id]
            );
        }

        const [updatedPosts] = await pool.query(
            'SELECT post_id, globalrecommendscore, user_id FROM userpostsinfo WHERE is_deleted = FALSE'
        );

        return updatedPosts.map(row => ({
            post_id: row.post_id.toString(),
            globalrecommendscore: Number(row.globalrecommendscore),
            user_id: Number(row.user_id)
        }));
    } catch (err) {
        return [];
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:makepost|placeType:server|type:Function---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šmakepost
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
  - Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (timestamp [Type:int],userID [Type:int])
         
         return: (a string [type:string])
         
         logic:
         
         å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
  - generatePostId (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input:(timestamp [Type: int],userId [Type: int])
         
         return: (a big INT number [Type: BigInt])
         
         Logic:
         è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
  - modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
         
         return: (a string [type:string])
         
         
         logic:
         å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
         å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
  - modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (user_ID [Type:int],post_id [Type:int])
         
         function type: it is async
         
         return: (a string [type:string])
         logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);

return: (a string [type:string])


logic:
do things as below. if they all succeed,then return "success";otherwise, return "false".

     const userID=await searchuserIDbyusername(username);
     await Appenduserpostsinfo(secondTime,userID);
     const post_id=generatePostId(secondTime,userID);
     await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
		
     await modifyuserpostsinfouserID(userID,post_id);

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
async function makepost(username, imagepath, article, secondTime) {
    try {
        const userID = await searchuserIDbyusername(username);
        if (userID === null) return "fail";

        const appendResult = await Appenduserpostsinfo(secondTime, userID);
        if (appendResult !== "success") return "fail";

        const post_id = generatePostId(secondTime, userID);

        const modifyResult = await modifyuserpostsinfo(post_id, secondTime, article, imagepath);
        if (modifyResult !== "success") return "fail";

        const userIDUpdateResult = await modifyuserpostsinfouserID(userID, post_id);
        if (userIDUpdateResult !== "success") return "fail";

        return "success";
    } catch (err) {
        return "fail";
    }
}


/* ----------------prompt-----Id: filename:./application/sqldatacenter.js|name:sqldatacenter|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsqldatacenter
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/sqldatacenter.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - pool (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         const pool = mysql.createPool({
             host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
             user: sqlusername,
             password: sqlpassword,
             database: 'testdatabase',
             waitForConnections: true,
             connectionLimit: 10,
             queueLimit: 0
         }).promise();
    - calls mysql (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
      - import from module (GlobalVariable) in mysql2
        æè¿°ï¼š
           it is an external module. no need to write it
    - calls sqlusername (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
      - import from sqlusername (GlobalVariable) in ./application/sqlusername
        æè¿°ï¼š
           I'll do it by my self
    - calls sqlpassword (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
      - import from sqlpassword (GlobalVariable) in ./application/sqlpassword
        æè¿°ï¼š
           I'll do it By myself
  - readPostByPost_id (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input:(post_id)
         
         return: ([type:json])
         
         function type: it is async
         
         logic:
         å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - sendlike (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (user_id [type:int],post_id [type:int])
         
         return: ( a string [type:string])
         
         function type: it is async
         
         logic:
         å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userlikesinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
          
          - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
          - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
          - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
          
          +------------+------------------+------+-----+-------------------+-----------------------+
          | Field      | Type             | Null | Key | Default           | Extra                 |
          +------------+------------------+------+-----+-------------------+-----------------------+
          | user_id    | bigint           | NO   | PRI | NULL              |                       |
          | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
          | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          +------------+------------------+------+-----+-------------------+-----------------------+
    - writes_table userlikesinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
          
          - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
          - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
          - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
          
          +------------+------------------+------+-----+-------------------+-----------------------+
          | Field      | Type             | Null | Key | Default           | Extra                 |
          +------------+------------------+------+-----+-------------------+-----------------------+
          | user_id    | bigint           | NO   | PRI | NULL              |                       |
          | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
          | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          +------------+------------------+------+-----+-------------------+-----------------------+
    - writes_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - unsendlike (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (user_id [type:int],post_id [type:int])
         
         return: ( a string [type:string])
         
         
         function type: it is async
         
         logic:
         å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
    - reads_table userlikesinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
          
          - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
          - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
          - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
          
          +------------+------------------+------+-----+-------------------+-----------------------+
          | Field      | Type             | Null | Key | Default           | Extra                 |
          +------------+------------------+------+-----+-------------------+-----------------------+
          | user_id    | bigint           | NO   | PRI | NULL              |                       |
          | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
          | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          +------------+------------------+------+-----+-------------------+-----------------------+
    - writes_table userlikesinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
          
          - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
          - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
          - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
          
          +------------+------------------+------+-----+-------------------+-----------------------+
          | Field      | Type             | Null | Key | Default           | Extra                 |
          +------------+------------------+------+-----+-------------------+-----------------------+
          | user_id    | bigint           | NO   | PRI | NULL              |                       |
          | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
          | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          +------------+------------------+------+-----+-------------------+-----------------------+
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: no input
         
         return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
         globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
         
         
         function type: it is async
         
         
         logic:
         
         å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
         
         æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
    - reads_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
    - calls GlobalRecommendNumberCalculator (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input :(like_count[type:int ],timeSincePosted [type:int])
          
          return (score [Type:int)
          
          logic:
          
          return Math.round(1000*like_count+1000000*Math.exp(-lambda*(timeï¼³inceï¼°osted/1000)))
  - searchlike_count (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (post_id [Type:int ])
         
         function type: it is async
         
         return (a number or null [type:int])
         logic:
         å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - makepost (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
         
         return: (a string [type:string])
         
         
         logic:
         do things as below. if they all succeed,then return "success";otherwise, return "false".
         
              const userID=await searchuserIDbyusername(username);
              await Appenduserpostsinfo(secondTime,userID);
              const post_id=generatePostId(secondTime,userID);
              await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
         		
              await modifyuserpostsinfouserID(userID,post_id);
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - calls Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (timestamp [Type:int],userID [Type:int])
          
          return: (a string [type:string])
          
          logic:
          
          å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
    - calls generatePostId (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input:(timestamp [Type: int],userId [Type: int])
          
          return: (a big INT number [Type: BigInt])
          
          Logic:
          è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
    - calls modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
          
          return: (a string [type:string])
          
          
          logic:
          å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
          å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
    - calls modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (user_ID [Type:int],post_id [Type:int])
          
          function type: it is async
          
          return: (a string [type:string])
          logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
  - diduserlikepost (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (user_id [type:int ],post_id [type:int])
         
         return: (a boolean [Type:boolean])
         
         logic: 
         å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userlikesinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
          
          - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
          - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
          - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
          
          +------------+------------------+------+-----+-------------------+-----------------------+
          | Field      | Type             | Null | Key | Default           | Extra                 |
          +------------+------------------+------+-----+-------------------+-----------------------+
          | user_id    | bigint           | NO   | PRI | NULL              |                       |
          | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
          | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
          +------------+------------------+------+-----+-------------------+-----------------------+
  - Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (timestamp [Type:int],userID [Type:int])
         
         return: (a string [type:string])
         
         logic:
         
         å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
         
         return: (a string [type:string])
         
         
         logic:
         å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
         å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - searchuserIDbyusername (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (username [type:string])
         
         return: int or null
         
         logic:
         å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
          
          user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
          
          usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
          
          +----------+-------------+------+-----+---------+----------------+
          | Field    | Type        | Null | Key | Default | Extra          |
          +----------+-------------+------+-----+---------+----------------+
          | user_id  | int         | NO   | PRI | NULL    | auto_increment |
          | username | varchar(50) | NO   | UNI | NULL    |                |
          +----------+-------------+------+-----+---------+----------------+
  - searchusernamebyuserID (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (userID [type:int])
         
         return: string or null
         
         logic:
         å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
          
          user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
          
          usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
          
          +----------+-------------+------+-----+---------+----------------+
          | Field    | Type        | Null | Key | Default | Extra          |
          +----------+-------------+------+-----+---------+----------------+
          | user_id  | int         | NO   | PRI | NULL    | auto_increment |
          | username | varchar(50) | NO   | UNI | NULL    |                |
          +----------+-------------+------+-----+---------+----------------+
  - checkuserexists (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (username [type:string])
         
         return: boolean
         
         logic:
         å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
    - reads_table userinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
          
          user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
          
          usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
          
          +----------+-------------+------+-----+---------+----------------+
          | Field    | Type        | Null | Key | Default | Extra          |
          +----------+-------------+------+-----+---------+----------------+
          | user_id  | int         | NO   | PRI | NULL    | auto_increment |
          | username | varchar(50) | NO   | UNI | NULL    |                |
          +----------+-------------+------+-----+---------+----------------+
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
  - modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (user_ID [Type:int],post_id [Type:int])
         
         function type: it is async
         
         return: (a string [type:string])
         logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userpostsinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
          
          - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
          - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
          - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
          - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
          - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
          - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
          - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
          - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
          - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
          - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
          - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
          - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
          - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
          - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
          
          +------------------------+------------------+------+-----+--------+-------+
          | Field                  | Type             | Null | Key | Default| Extra |
          +------------------------+------------------+------+-----+--------+-------+
          | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
          | user_id                | bigint            | NO   | MUL | NULL   |       |
          | like_count             | int unsigned      | YES  |     | 0      |       |
          | secondTime             | bigint            | YES  |     | NULL   |       |
          | article                | text              | YES  |     | NULL   |       |
          | imagepath              | varchar(500)      | YES  |     | NULL   |       |
          | created_at             | datetime          | YES  |     | NULL   |       |
          | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
          | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
          | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
          | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
          | is_banned              | tinyint(1)        | YES  |     | 0      |       |
          | ban_reason             | text              | YES  |     | NULL   |       |
          | ban_at                 | datetime          | YES  |     | NULL   |       |
          +------------------------+------------------+------+-----+--------+-------+
  - Verify_LoginToken (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input:(username [Type: string],token [Type: string])
         
         return (true or false [Type:boolean])
         
         function type: it is async
         
         Logic:
         å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userLoginToken (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
          
          username
          
          tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
          
          issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          
          expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
          
          created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
          
          
          +------------+--------------+------+-----+---------------------+----------------+
          | Field      | Type         | Null | Key | Default             | Extra          |
          +------------+--------------+------+-----+---------------------+----------------+
          | username   | varchar(50)  | NO   | PRI | NULL                |                |
          | token      | varchar(255) | NO   |     | NULL                |                |
          | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          | expires_at | timestamp    | YES  |     | NULL                |                |
          | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          +------------+--------------+------+-----+---------------------+----------------+
  - Write_LoginToken (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input:(username [Type: string])
         
         return : ( a json that contains state and token. state and token are string[Type: json])
         
         function type: it is async
         
         Logic:
         åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userLoginToken (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
          
          username
          
          tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
          
          issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          
          expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
          
          created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
          
          
          +------------+--------------+------+-----+---------------------+----------------+
          | Field      | Type         | Null | Key | Default             | Extra          |
          +------------+--------------+------+-----+---------------------+----------------+
          | username   | varchar(50)  | NO   | PRI | NULL                |                |
          | token      | varchar(255) | NO   |     | NULL                |                |
          | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          | expires_at | timestamp    | YES  |     | NULL                |                |
          | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          +------------+--------------+------+-----+---------------------+----------------+
    - calls jwt (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          just import it
      - import from module (GlobalVariable) in jsonwebtoken
        æè¿°ï¼š
           it is an external module. no need to write it
    - calls JWT_SECRET (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          I will do this
  - generatePostId (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input:(timestamp [Type: int],userId [Type: int])
         
         return: (a big INT number [Type: BigInt])
         
         Logic:
         è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
  - Write_HashedPassword (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         since i don't need it now, just write it as am empty function
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userHashedPassword (Table) in newTestdatabase
      æè¿°ï¼š
          | Field            | Type           | Null | Key | Default | Extra |
          | ---------------- | -------------- | ---- | --- | ------- | ----- |
          | username         | varchar(50)    | NO   | PRI | NULL    |       |
          | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
          
          
          ç”¨é€”èªªæ˜ï¼š
          æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
          
          | æ¬„ä½åç¨±              | èªªæ˜                                                                |
          | ----------------- | ----------------------------------------------------------------- |
          | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
          | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
  - Verify_HashedPassword (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (username [type:string],hashedpassword [type:string])
         
         return: boolean
         
         logic:
         ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - reads_table userHashedPassword (Table) in newTestdatabase
      æè¿°ï¼š
          | Field            | Type           | Null | Key | Default | Extra |
          | ---------------- | -------------- | ---- | --- | ------- | ----- |
          | username         | varchar(50)    | NO   | PRI | NULL    |       |
          | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
          
          
          ç”¨é€”èªªæ˜ï¼š
          æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
          
          | æ¬„ä½åç¨±              | èªªæ˜                                                                |
          | ----------------- | ----------------------------------------------------------------- |
          | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
          | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
  - Create_UserAccount (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input: (username [type:string],hashedpassword [type:string])
         
         return: a string 
         
         logic:
         mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
    - writes_table userHashedPassword (Table) in newTestdatabase
      æè¿°ï¼š
          | Field            | Type           | Null | Key | Default | Extra |
          | ---------------- | -------------- | ---- | --- | ------- | ----- |
          | username         | varchar(50)    | NO   | PRI | NULL    |       |
          | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
          
          
          ç”¨é€”èªªæ˜ï¼š
          æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
          
          | æ¬„ä½åç¨±              | èªªæ˜                                                                |
          | ----------------- | ----------------------------------------------------------------- |
          | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
          | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
    - writes_table userinfo (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
          
          user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
          
          usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
          
          +----------+-------------+------+-----+---------+----------------+
          | Field    | Type        | Null | Key | Default | Extra          |
          +----------+-------------+------+-----+---------+----------------+
          | user_id  | int         | NO   | PRI | NULL    | auto_increment |
          | username | varchar(50) | NO   | UNI | NULL    |                |
          +----------+-------------+------+-----+---------+----------------+
    - writes_table userLoginToken (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
          
          username
          
          tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
          
          issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          
          expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
          
          created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
          
          
          +------------+--------------+------+-----+---------------------+----------------+
          | Field      | Type         | Null | Key | Default             | Extra          |
          +------------+--------------+------+-----+---------------------+----------------+
          | username   | varchar(50)  | NO   | PRI | NULL                |                |
          | token      | varchar(255) | NO   |     | NULL                |                |
          | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          | expires_at | timestamp    | YES  |     | NULL                |                |
          | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          +------------+--------------+------+-----+---------------------+----------------+
  - logout (Function) in ./application/sqldatacenter.js
    æè¿°ï¼š
         input :(username [type:string])
         
         
         return : (a string [type: string])
         
         logic:
         
         å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".
    - writes_table userLoginToken (Table) in newTestdatabase
      æè¿°ï¼š
          é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
          
          username
          
          tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
          
          issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
          
          expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
          
          created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
          
          
          +------------+--------------+------+-----+---------------------+----------------+
          | Field      | Type         | Null | Key | Default             | Extra          |
          +------------+--------------+------+-----+---------------------+----------------+
          | username   | varchar(50)  | NO   | PRI | NULL                |                |
          | token      | varchar(255) | NO   |     | NULL                |                |
          | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          | expires_at | timestamp    | YES  |     | NULL                |                |
          | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
          +------------+--------------+------+-----+---------------------+----------------+
    - calls pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
let it own what it should own

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const mysql = require('mysql2');
const sqlusername = require('./sqlusername');
const sqlpassword = require('./sqlpassword');
const jwt = require('jsonwebtoken');
const JWT_SECRET = 'your_secret_key_here'; // ä½ æœƒè‡ªè¡Œè™•ç†é€™ä¸€è¡Œ

const pool = mysql.createPool({
    host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
    user: sqlusername,
    password: sqlpassword,
    database: 'testdatabase',
    waitForConnections: true,
    connectionLimit: 10,
    queueLimit: 0
}).promise();
