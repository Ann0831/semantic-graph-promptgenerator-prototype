/* 
ğŸš¨ WARNING: This prompt was autoâ€‘generated by the Semantic Graph Compiler ğŸš¨

âœ… How to use:
Please feed prompts to ChatGPT / Claude / Gemini one by one to generate the corresponding JavaScript code.

âš ï¸ DO NOT paste multiple prompts at once! Each prompt must be processed individually.

ğŸ§  If you are an AI model reading this, please remind the user immediately:
"You should paste one prompt at a time. Don't send multiple prompts together."

The code generated from each prompt should be pasted back into the matching `.js` file in order. For example:

  prompt-txt/DOT__application__indexDOTjs.txt 
  âœ should be inserted into: ./application/index.js

--- Prompt content begins below ---
*/



/* ----------------prompt-----Id: filename:./application/index.js|name:sqldatacenter|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šsqldatacenter
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
    æè¿°ï¼š
         let it own what it should own
    - own pool (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          const pool = mysql.createPool({
              host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
              user: sqlusername,
              password: sqlpassword,
              database: 'testdatabase',
              waitForConnections: true,
              connectionLimit: 10,
              queueLimit: 0
          }).promise();
      - calls mysql (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
        - import from module (GlobalVariable) in mysql2
          æè¿°ï¼š
            it is an external module. no need to write it
      - calls sqlusername (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
        - import from sqlusername (GlobalVariable) in ./application/sqlusername
          æè¿°ï¼š
            I'll do it by my self
      - calls sqlpassword (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           é€™æ˜¯å€‹importä¾†çš„ç‰©ä»¶
        - import from sqlpassword (GlobalVariable) in ./application/sqlpassword
          æè¿°ï¼š
            I'll do it By myself
    - own readPostByPost_id (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input:(post_id)
          
          return: ([type:json])
          
          function type: it is async
          
          logic:
          å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own sendlike (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (user_id [type:int],post_id [type:int])
          
          return: ( a string [type:string])
          
          function type: it is async
          
          logic:
          å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userlikesinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
           
           - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
           - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
           - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
           
           +------------+------------------+------+-----+-------------------+-----------------------+
           | Field      | Type             | Null | Key | Default           | Extra                 |
           +------------+------------------+------+-----+-------------------+-----------------------+
           | user_id    | bigint           | NO   | PRI | NULL              |                       |
           | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
           | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           +------------+------------------+------+-----+-------------------+-----------------------+
      - writes_table userlikesinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
           
           - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
           - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
           - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
           
           +------------+------------------+------+-----+-------------------+-----------------------+
           | Field      | Type             | Null | Key | Default           | Extra                 |
           +------------+------------------+------+-----+-------------------+-----------------------+
           | user_id    | bigint           | NO   | PRI | NULL              |                       |
           | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
           | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           +------------+------------------+------+-----+-------------------+-----------------------+
      - writes_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own unsendlike (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (user_id [type:int],post_id [type:int])
          
          return: ( a string [type:string])
          
          
          function type: it is async
          
          logic:
          å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - reads_table userlikesinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
           
           - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
           - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
           - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
           
           +------------+------------------+------+-----+-------------------+-----------------------+
           | Field      | Type             | Null | Key | Default           | Extra                 |
           +------------+------------------+------+-----+-------------------+-----------------------+
           | user_id    | bigint           | NO   | PRI | NULL              |                       |
           | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
           | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           +------------+------------------+------+-----+-------------------+-----------------------+
      - writes_table userlikesinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
           
           - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
           - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
           - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
           
           +------------+------------------+------+-----+-------------------+-----------------------+
           | Field      | Type             | Null | Key | Default           | Extra                 |
           +------------+------------------+------+-----+-------------------+-----------------------+
           | user_id    | bigint           | NO   | PRI | NULL              |                       |
           | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
           | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           +------------+------------------+------+-----+-------------------+-----------------------+
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: no input
          
          return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
          globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
          
          
          function type: it is async
          
          
          logic:
          
          å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
          
          æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
      - reads_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
      - calls GlobalRecommendNumberCalculator (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(like_count[type:int ],timeSincePosted [type:int])
           
           return (score [Type:int)
           
           logic:
           
           return Math.round(1000*like_count+1000000*Math.exp(-lambda*(timeï¼³inceï¼°osted/1000)))
    - own searchlike_count (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (post_id [Type:int ])
          
          function type: it is async
          
          return (a number or null [type:int])
          logic:
          å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own makepost (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
          
          return: (a string [type:string])
          
          
          logic:
          do things as below. if they all succeed,then return "success";otherwise, return "false".
          
               const userID=await searchuserIDbyusername(username);
               await Appenduserpostsinfo(secondTime,userID);
               const post_id=generatePostId(secondTime,userID);
               await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
          		
               await modifyuserpostsinfouserID(userID,post_id);
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - calls Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - calls generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - calls modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - calls modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
    - own diduserlikepost (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (user_id [type:int ],post_id [type:int])
          
          return: (a boolean [Type:boolean])
          
          logic: 
          å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userlikesinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç”¨æˆ¶å°è²¼æ–‡æŒ‰è®šè¡Œç‚ºçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨æŸå€‹ç”¨æˆ¶å°æŸç¯‡è²¼æ–‡çš„ä¸€æ¬¡å–œæ­¡å‹•ä½œã€‚
           
           - `user_id`ï¼šåŸ·è¡ŒæŒ‰è®šè¡Œç‚ºçš„ä½¿ç”¨è€… IDï¼Œç‚ºä¸»éµä¹‹ä¸€ã€‚
           - `post_id`ï¼šè¢«æŒ‰è®šçš„è²¼æ–‡ IDï¼Œç‚ºä¸»éµä¹‹ä¸€ï¼Œèˆ‡ user_id å…±åŒæ§‹æˆè¤‡åˆä¸»éµã€‚
           - `liked_at`ï¼šæŒ‰è®šçš„æ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           - `created_at`ï¼šç´€éŒ„å»ºç«‹æ™‚é–“ï¼Œèˆ‡ liked_at å¯ç›¸åŒï¼Œä½œç‚ºè³‡æ–™å»ºç«‹è¿½è¹¤ã€‚
           
           +------------+------------------+------+-----+-------------------+-----------------------+
           | Field      | Type             | Null | Key | Default           | Extra                 |
           +------------+------------------+------+-----+-------------------+-----------------------+
           | user_id    | bigint           | NO   | PRI | NULL              |                       |
           | post_id    | decimal(30,0)    | NO   | PRI | NULL              |                       |
           | liked_at   | timestamp        | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           | created_at | datetime         | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED     |
           +------------+------------------+------+-----+-------------------+-----------------------+
    - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (timestamp [Type:int],userID [Type:int])
          
          return: (a string [type:string])
          
          logic:
          
          å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
          
          return: (a string [type:string])
          
          
          logic:
          å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
          å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (username [type:string])
          
          return: int or null
          
          logic:
          å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
           
           user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
           
           usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
           
           +----------+-------------+------+-----+---------+----------------+
           | Field    | Type        | Null | Key | Default | Extra          |
           +----------+-------------+------+-----+---------+----------------+
           | user_id  | int         | NO   | PRI | NULL    | auto_increment |
           | username | varchar(50) | NO   | UNI | NULL    |                |
           +----------+-------------+------+-----+---------+----------------+
    - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (userID [type:int])
          
          return: string or null
          
          logic:
          å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
           
           user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
           
           usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
           
           +----------+-------------+------+-----+---------+----------------+
           | Field    | Type        | Null | Key | Default | Extra          |
           +----------+-------------+------+-----+---------+----------------+
           | user_id  | int         | NO   | PRI | NULL    | auto_increment |
           | username | varchar(50) | NO   | UNI | NULL    |                |
           +----------+-------------+------+-----+---------+----------------+
    - own checkuserexists (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (username [type:string])
          
          return: boolean
          
          logic:
          å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - reads_table userinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
           
           user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
           
           usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
           
           +----------+-------------+------+-----+---------+----------------+
           | Field    | Type        | Null | Key | Default | Extra          |
           +----------+-------------+------+-----+---------+----------------+
           | user_id  | int         | NO   | PRI | NULL    | auto_increment |
           | username | varchar(50) | NO   | UNI | NULL    |                |
           +----------+-------------+------+-----+---------+----------------+
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
    - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (user_ID [Type:int],post_id [Type:int])
          
          function type: it is async
          
          return: (a string [type:string])
          logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userpostsinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç´€éŒ„ä½¿ç”¨è€…è²¼æ–‡è³‡æ–™çš„ä¸»è¦è¡¨æ ¼ï¼ŒåŒ…å«è²¼æ–‡å…§å®¹ã€æŒ‰è®šæ•¸ã€å»ºç«‹æ™‚é–“ã€åœ–ç‰‡è·¯å¾‘èˆ‡æ¨è–¦åˆ†æ•¸ç­‰æ¬„ä½ï¼Œäº¦æ”¯æ´åˆªé™¤èˆ‡å°é–é‚è¼¯ã€‚
           
           - `post_id`ï¼šè²¼æ–‡çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµã€‚
           - `user_id`ï¼šç™¼æ–‡è€…çš„ç”¨æˆ¶ IDã€‚
           - `like_count`ï¼šæ­¤è²¼æ–‡ç´¯ç©çš„æŒ‰è®šæ•¸ï¼Œåˆå§‹ç‚º 0ã€‚
           - `secondTime`ï¼šä½¿ç”¨è€…åœ¨ç™¼æ–‡ç•¶ä¸‹åœç•™æ–¼å‰µä½œé çš„æ¯«ç§’æ•¸ï¼Œå¯ä½œç‚ºå‰µä½œæŠ•å…¥ç¨‹åº¦æˆ–å“è³ªé æ¸¬æŒ‡æ¨™ã€‚
           - `article`ï¼šè²¼æ–‡çš„æ­£æ–‡å…§å®¹ã€‚
           - `imagepath`ï¼šé™„åŠ åœ–ç‰‡çš„å„²å­˜è·¯å¾‘ï¼ˆURL æˆ–æª”åï¼‰ã€‚
           - `created_at`ï¼šè²¼æ–‡ç™¼è¡¨æ™‚é–“ã€‚
           - `globalrecommendscore`ï¼šå…¨å±€æ¨è–¦åˆ†æ•¸ï¼Œå¯èƒ½ç”±æ¨è–¦ç³»çµ±æ¼”ç®—æ³•ç”¢å‡ºï¼Œç”¨ä¾†æ’åºæˆ–æ›å…‰ã€‚
           - `is_deleted`ï¼šé‚è¼¯åˆªé™¤æ¨™è¨˜ï¼Œ0 è¡¨ç¤ºæ­£å¸¸ï¼Œ1 è¡¨ç¤ºå·²åˆªé™¤ã€‚
           - `deleted_at_seconds`ï¼šåˆªé™¤æ™‚é–“çš„ Unix timestampã€‚
           - `deleted_at_datetime`ï¼šåˆªé™¤æ™‚é–“çš„ datetime æ ¼å¼ã€‚
           - `is_banned`ï¼šæ˜¯å¦å› é•è¦ç­‰åŸå› è¢«å°é–ï¼ˆè²¼æ–‡ç„¡æ³•é¡¯ç¤ºï¼‰ã€‚
           - `ban_reason`ï¼šå°é–ç†ç”±æ–‡å­—èªªæ˜ã€‚
           - `ban_at`ï¼šè²¼æ–‡è¢«å°é–çš„æ™‚é–“ã€‚
           
           +------------------------+------------------+------+-----+--------+-------+
           | Field                  | Type             | Null | Key | Default| Extra |
           +------------------------+------------------+------+-----+--------+-------+
           | post_id                | decimal(30,0)     | NO   | PRI | NULL   |       |
           | user_id                | bigint            | NO   | MUL | NULL   |       |
           | like_count             | int unsigned      | YES  |     | 0      |       |
           | secondTime             | bigint            | YES  |     | NULL   |       |
           | article                | text              | YES  |     | NULL   |       |
           | imagepath              | varchar(500)      | YES  |     | NULL   |       |
           | created_at             | datetime          | YES  |     | NULL   |       |
           | globalrecommendscore   | bigint            | YES  |     | NULL   |       |
           | is_deleted             | tinyint(1)        | YES  |     | 0      |       |
           | deleted_at_seconds     | bigint            | YES  |     | NULL   |       |
           | deleted_at_datetime    | datetime          | YES  |     | NULL   |       |
           | is_banned              | tinyint(1)        | YES  |     | 0      |       |
           | ban_reason             | text              | YES  |     | NULL   |       |
           | ban_at                 | datetime          | YES  |     | NULL   |       |
           +------------------------+------------------+------+-----+--------+-------+
    - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input:(username [Type: string],token [Type: string])
          
          return (true or false [Type:boolean])
          
          function type: it is async
          
          Logic:
          å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userLoginToken (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
           
           username
           
           tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
           
           issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           
           expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
           
           created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
           
           
           +------------+--------------+------+-----+---------------------+----------------+
           | Field      | Type         | Null | Key | Default             | Extra          |
           +------------+--------------+------+-----+---------------------+----------------+
           | username   | varchar(50)  | NO   | PRI | NULL                |                |
           | token      | varchar(255) | NO   |     | NULL                |                |
           | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           | expires_at | timestamp    | YES  |     | NULL                |                |
           | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           +------------+--------------+------+-----+---------------------+----------------+
    - own Write_LoginToken (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input:(username [Type: string])
          
          return : ( a json that contains state and token. state and token are string[Type: json])
          
          function type: it is async
          
          Logic:
          åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userLoginToken (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
           
           username
           
           tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
           
           issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           
           expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
           
           created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
           
           
           +------------+--------------+------+-----+---------------------+----------------+
           | Field      | Type         | Null | Key | Default             | Extra          |
           +------------+--------------+------+-----+---------------------+----------------+
           | username   | varchar(50)  | NO   | PRI | NULL                |                |
           | token      | varchar(255) | NO   |     | NULL                |                |
           | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           | expires_at | timestamp    | YES  |     | NULL                |                |
           | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           +------------+--------------+------+-----+---------------------+----------------+
      - calls jwt (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           just import it
        - import from module (GlobalVariable) in jsonwebtoken
          æè¿°ï¼š
            it is an external module. no need to write it
      - calls JWT_SECRET (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           I will do this
    - own generatePostId (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input:(timestamp [Type: int],userId [Type: int])
          
          return: (a big INT number [Type: BigInt])
          
          Logic:
          è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
    - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          since i don't need it now, just write it as am empty function
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userHashedPassword (Table) in newTestdatabase
        æè¿°ï¼š
           | Field            | Type           | Null | Key | Default | Extra |
           | ---------------- | -------------- | ---- | --- | ------- | ----- |
           | username         | varchar(50)    | NO   | PRI | NULL    |       |
           | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
           
           
           ç”¨é€”èªªæ˜ï¼š
           æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
           
           | æ¬„ä½åç¨±              | èªªæ˜                                                                |
           | ----------------- | ----------------------------------------------------------------- |
           | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
           | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
    - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (username [type:string],hashedpassword [type:string])
          
          return: boolean
          
          logic:
          ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - reads_table userHashedPassword (Table) in newTestdatabase
        æè¿°ï¼š
           | Field            | Type           | Null | Key | Default | Extra |
           | ---------------- | -------------- | ---- | --- | ------- | ----- |
           | username         | varchar(50)    | NO   | PRI | NULL    |       |
           | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
           
           
           ç”¨é€”èªªæ˜ï¼š
           æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
           
           | æ¬„ä½åç¨±              | èªªæ˜                                                                |
           | ----------------- | ----------------------------------------------------------------- |
           | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
           | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
    - own Create_UserAccount (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input: (username [type:string],hashedpassword [type:string])
          
          return: a string 
          
          logic:
          mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - writes_table userHashedPassword (Table) in newTestdatabase
        æè¿°ï¼š
           | Field            | Type           | Null | Key | Default | Extra |
           | ---------------- | -------------- | ---- | --- | ------- | ----- |
           | username         | varchar(50)    | NO   | PRI | NULL    |       |
           | hashed_password  | varchar(255)   | NO   |     | NULL    |       |
           
           
           ç”¨é€”èªªæ˜ï¼š
           æ­¤è³‡æ–™è¡¨ç”¨æ–¼å„²å­˜ä½¿ç”¨è€…å¸³è™ŸåŠå…¶å°æ‡‰çš„é›œæ¹Šå¾Œå¯†ç¢¼ï¼Œç”¨æ–¼ç™»å…¥èº«ä»½é©—è­‰ã€‚ç³»çµ±åƒ…ä¿å­˜ä¸å¯é€†çš„é›œæ¹Šå­—ä¸²ï¼Œä¸å„²å­˜æ˜æ–‡å¯†ç¢¼ã€‚æ¯ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…ã€‚
           
           | æ¬„ä½åç¨±              | èªªæ˜                                                                |
           | ----------------- | ----------------------------------------------------------------- |
           | `username`        | ä½¿ç”¨è€…å¸³è™Ÿï¼Œç‚ºä¸»éµã€‚é™åˆ¶é•·åº¦ç‚º 50 å€‹å­—å…ƒï¼Œå¿…é ˆå”¯ä¸€ä¸”ä¸å¯ç‚º NULLã€‚æ­¤æ¬„ä½ç”¨æ–¼è¾¨è­˜ä½¿ç”¨è€…èº«åˆ†ã€‚                |
           | `hashed_password` | é›œæ¹Šå¾Œçš„å¯†ç¢¼å­—ä¸²ã€‚é•·åº¦ä¸Šé™ç‚º 255 å­—å…ƒï¼Œå»ºè­°ä½¿ç”¨ bcryptã€argon2 ç­‰å®‰å…¨æ¼”ç®—æ³•é›œæ¹Šå¾Œå„²å­˜ã€‚æ­¤æ¬„ä½ä¸å¯ç‚º NULLã€‚ |
      - writes_table userinfo (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ç³»çµ±ä¸­æ‰€æœ‰ä½¿ç”¨è€…åŸºæœ¬è³‡è¨Šçš„è³‡æ–™è¡¨ï¼Œæ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½è¨»å†Šç”¨æˆ¶ã€‚
           
           user_idï¼šä½¿ç”¨è€…çš„å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç‚ºä¸»éµï¼Œæ•´æ•¸å‹åˆ¥ï¼Œè‡ªå‹•éå¢ã€‚
           
           usernameï¼šä½¿ç”¨è€…å¸³è™Ÿåç¨±ï¼Œç‚ºæ–‡å­—å‹åˆ¥ï¼ˆvarcharï¼‰ï¼Œå¿…é ˆå”¯ä¸€ã€ä¸å¾—ç‚ºç©ºï¼Œç”¨ä¾†è¾¨è­˜è©²ç”¨æˆ¶åœ¨ç³»çµ±ä¸­çš„å…¬é–‹åç¨±ã€‚
           
           +----------+-------------+------+-----+---------+----------------+
           | Field    | Type        | Null | Key | Default | Extra          |
           +----------+-------------+------+-----+---------+----------------+
           | user_id  | int         | NO   | PRI | NULL    | auto_increment |
           | username | varchar(50) | NO   | UNI | NULL    |                |
           +----------+-------------+------+-----+---------+----------------+
      - writes_table userLoginToken (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
           
           username
           
           tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
           
           issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           
           expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
           
           created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
           
           
           +------------+--------------+------+-----+---------------------+----------------+
           | Field      | Type         | Null | Key | Default             | Extra          |
           +------------+--------------+------+-----+---------------------+----------------+
           | username   | varchar(50)  | NO   | PRI | NULL                |                |
           | token      | varchar(255) | NO   |     | NULL                |                |
           | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           | expires_at | timestamp    | YES  |     | NULL                |                |
           | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           +------------+--------------+------+-----+---------------------+----------------+
    - own logout (Function) in ./application/sqldatacenter.js
      æè¿°ï¼š
          input :(username [type:string])
          
          
          return : (a string [type: string])
          
          logic:
          
          å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".
      - writes_table userLoginToken (Table) in newTestdatabase
        æè¿°ï¼š
           é€™æ˜¯ä¸€å¼µç”¨ä¾†è¨˜éŒ„ä½¿ç”¨è€…ç™»å…¥ç‹€æ…‹èˆ‡ token çš„è³‡æ–™è¡¨ã€‚æ¯ä¸€ç­†ç´€éŒ„ä»£è¡¨ä¸€ä½ä½¿ç”¨è€…åœ¨æŸå€‹æ™‚é–“é»æ‰€ç²é ’çš„ä¸€çµ„ç™»å…¥ tokenï¼Œç”¨æ–¼é©—è­‰å…¶ç™»å…¥èº«ä»½ã€‚
           
           username
           
           tokenï¼šç™¼æ”¾çµ¦è©²ä½¿ç”¨è€…çš„ç™»å…¥æ†‘è­‰ï¼Œç”¨æ–¼å­˜å–å—ä¿è­·è³‡æºã€‚
           
           issued_atï¼štoken ç™¼è¡Œæ™‚é–“ï¼Œç‚º timestampï¼Œé è¨­ç‚ºç•¶ä¸‹æ™‚é–“ã€‚
           
           expires_atï¼štoken çš„éæœŸæ™‚é–“ï¼Œè‹¥å·²éæœŸå‰‡ç„¡æ•ˆï¼Œç‚º timestampã€‚
           
           created_atï¼šè³‡æ–™å»ºç«‹æ™‚é–“ï¼Œå¯èˆ‡ issued_at ç›¸åŒï¼Œç”¨æ–¼ç¨½æ ¸èˆ‡ç´€éŒ„è¿½è¹¤ã€‚
           
           
           +------------+--------------+------+-----+---------------------+----------------+
           | Field      | Type         | Null | Key | Default             | Extra          |
           +------------+--------------+------+-----+---------------------+----------------+
           | username   | varchar(50)  | NO   | PRI | NULL                |                |
           | token      | varchar(255) | NO   |     | NULL                |                |
           | issued_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           | expires_at | timestamp    | YES  |     | NULL                |                |
           | created_at | timestamp    | NO   |     | CURRENT_TIMESTAMP   |                |
           +------------+--------------+------+-----+---------------------+----------------+
      - calls pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import it

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const sqldatacenter = require('./application/sqldatacenter.js');


/* ----------------prompt-----Id: filename:./application/index.js|name:path|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špath
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in path
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const path = require('path');

/* ----------------prompt-----Id: filename:./application/index.js|name:express|placeType:server|type:GlobalVariable---------------- */

/*
<START>

å…ƒä»¶åç¨±ï¼šexpress
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in express
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const express = require('express');


/* ----------------prompt-----Id: filename:./application/index.js|name:cookie|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šcookie
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in cookie
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

const cookie = require('cookie');


/* ----------------prompt-----Id: filename:./application/index.js|name:multer|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šmulter
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in multer
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const multer = require('multer');


/* ----------------prompt-----Id: filename:./application/index.js|name:cookieparser|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šcookieparser
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in cookie-parser
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const cookieparser = require('cookie-parser');


/* ----------------prompt-----Id: filename:./application/index.js|name:fs|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šfs
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - module (GlobalVariable) in fs
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import the module

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const fs = require('fs');


/* ----------------prompt-----Id: filename:./application/index.js|name:app|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šapp
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - express (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in express
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
it is an external module. no need to write it

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

const app = express();


/* ----------------prompt-----Id: filename:./application/index.js|name:storage|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šstorage
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - multer (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in multer
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
const storage=multer.memoryStorage();

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

const storage = multer.memoryStorage();


/* ----------------prompt-----Id: filename:./application/index.js|name:upload|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šupload
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - multer (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in multer
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
const upload=multer({"storage":storage});

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const upload = multer({ storage: storage });


/* ----------------prompt-----Id: filename:./application/index.js|name:options|placeType:server|type:GlobalVariable---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šoptions
é¡å‹ï¼šGlobalVariable
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - fs (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in fs
      æè¿°ï¼š
          it is an external module. no need to write it
  - /etc/letsencrypt/live/gotestapp.com/privkey.pem (server_file) in /etc/letsencrypt/live/gotestapp.com/privkey.pem
    æè¿°ï¼š
         its is a file. No need to write it
  - /etc/letsencrypt/live/gotestapp.com/fullchain.pem (server_file) in /etc/letsencrypt/live/gotestapp.com/fullchain.pem
    æè¿°ï¼š
         its is a file. No need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
const options = {
  key: fs.readFileSync('/etc/letsencrypt/live/gotestapp.com/privkey.pem'),
  cert: fs.readFileSync('/etc/letsencrypt/live/gotestapp.com/fullchain.pem'),
  
};

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const options = {
  key: fs.readFileSync('/etc/letsencrypt/live/gotestapp.com/privkey.pem'),
  cert: fs.readFileSync('/etc/letsencrypt/live/gotestapp.com/fullchain.pem'),
};

/* ----------------prompt-----Id: filename:./application/index.js|name:cookieparser()|placeType:server|type:APIEndpoint[USE]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šcookieparser()
é¡å‹ï¼šAPIEndpoint[USE]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - cookieparser (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in cookie-parser
      æè¿°ï¼š
          it is an external module. no need to write it
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.use(cookieparser());

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

app.use(cookieparser());


/* ----------------prompt-----Id: filename:./application/index.js|name:express.json()|placeType:server|type:APIEndpoint[USE]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šexpress.json()
é¡å‹ï¼šAPIEndpoint[USE]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - express (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in express
      æè¿°ï¼š
          it is an external module. no need to write it
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.use(cookieparser());

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.use(express.json());


/* ----------------prompt-----Id: filename:./application/index.js|name:returnMainpage|placeType:server|type:Function---------------- */

/*
<START>

å…ƒä»¶åç¨±ï¼šreturnMainpage
é¡å‹ï¼šFunction
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - returnMainpage (Function) in ./application/returnMainpage.js
    æè¿°ï¼š
         input (username [type:string])


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
just import it

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const returnMainpage = require('./application/returnMainpage.js');


/* ----------------prompt-----Id: filename:./application/index.js|name:post_sendlike_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špost_sendlike_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (req,res)

return:éš¨æ„

logic: å…ˆæŠŠreqçš„cookieä¸­çš„usernameå’ŒtokenæŠ“å‡ºä¾†ï¼Œç„¶å¾Œåˆ©ç”¨sqldatacenter.Verify_LoginTokenä¾†åšç¢ºèªã€‚å¦‚æœèº«åˆ†é©—è­‰æ­£ç¢ºï¼Œé‚£å°±æŠ“å‡ºreq.bodyä¸­çš„user_idå’Œpost_idä¾†åŸ·è¡Œsqldatacenter.sendlikeã€‚å¦‚æœä¸€åˆ‡æˆåŠŸï¼Œå°±res.send({"state":"success"})ã€‚å¦‚æœéç¨‹ä¸­æœ‰ä»»ä½•å¤±æ•—ï¼Œä¾‹å¦‚èº«åˆ†é©—è­‰å¤±æ•—ï¼Œå°±res.send({"state":"fail"})ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const post_sendlike_handler = async (req, res) => {
  const { username, token } = req.cookies;

  const isVerified = await sqldatacenter.Verify_LoginToken(username, token);
  if (!isVerified) {
    res.send({ state: "fail" });
    return;
  }

  const { user_id, post_id } = req.body;
  const result = await sqldatacenter.sendlike(user_id, post_id);

  if (result === "success") {
    res.send({ state: "success" });
  } else {
    res.send({ state: "fail" });
  }
};


/* ----------------prompt-----Id: filename:./application/index.js|name:post_unsendlike_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špost_unsendlike_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (req,res)

return:éš¨æ„

logic: å…ˆæŠŠreqçš„cookieä¸­çš„usernameå’ŒtokenæŠ“å‡ºä¾†ï¼Œç„¶å¾Œåˆ©ç”¨sqldatacenter.Verify_LoginTokenä¾†åšç¢ºèªã€‚å¦‚æœèº«åˆ†é©—è­‰æ­£ç¢ºï¼Œé‚£å°±æŠ“å‡ºreq.bodyä¸­çš„user_idå’Œpost_idä¾†åŸ·è¡Œsqldatacenter.unsendlikeã€‚å¦‚æœä¸€åˆ‡æˆåŠŸï¼Œå°±res.send({"state":"success"})ã€‚å¦‚æœéç¨‹ä¸­æœ‰ä»»ä½•å¤±æ•—ï¼Œä¾‹å¦‚èº«åˆ†é©—è­‰å¤±æ•—ï¼Œå°±res.send({"state":"fail"})ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const post_unsendlike_handler = async (req, res) => {
  const { username, token } = req.cookies;

  const isVerified = await sqldatacenter.Verify_LoginToken(username, token);
  if (!isVerified) {
    res.send({ state: "fail" });
    return;
  }

  const { user_id, post_id } = req.body;
  const result = await sqldatacenter.unsendlike(user_id, post_id);

  if (result === "success") {
    res.send({ state: "success" });
  } else {
    res.send({ state: "fail" });
  }
};


/* ----------------prompt-----Id: filename:./application/index.js|name:post_register_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špost_register_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input (req,res)

return:éš¨æ„

logic:
å…ˆå»req.bodyæ‹¿å‡ºrequestedUsernameå’ŒrequestedHashed_Passwordã€‚ä½¿ç”¨sqldatacenter.checkuserexistsä¾†æŸ¥è©¢requestedUsernameé€™å€‹åç¨±æ˜¯å¦å·²è¢«è¨»å†Šã€‚å¦‚æœæ˜¯ï¼Œres.send("thisUsernameAlreadyExist")ã€‚å¦‚æœä¸æ˜¯ï¼Œä½¿ç”¨Create_UserAccountæŠŠrequestedUsernameå’ŒrequestedHashed_Passwordå¡«å…¥ï¼Œå¦‚æœä»–å›å‚³"success"ï¼Œå°±res.send("success")ï¼Œå¦‚æœå›å‚³"fail"ï¼Œå°±res.send("fail")ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const post_register_handler = async (req, res) => {
  const { requestedUsername, requestedHashed_Password } = req.body;

  const alreadyExists = await sqldatacenter.checkuserexists(requestedUsername);
  if (alreadyExists) {
    res.send("thisUsernameAlreadyExist");
    return;
  }

  const result = await sqldatacenter.Create_UserAccount(requestedUsername, requestedHashed_Password);
  if (result === "success") {
    res.send("success");
  } else {
    res.send("fail");
  }
};


/* ----------------prompt-----Id: filename:./application/index.js|name:post_login_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špost_login_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input (req,res)

return:éš¨æ„

logic
å°‡req.bodyä¸­çš„usernameå’Œhashed_passwordäº¤çµ¦sqldatacenter.Verify_HashedPasswordä¾†æª¢æŸ¥æ˜¯å¦æ­£ç¢ºï¼Œæ­£ç¢ºçš„è©±å°±sql.Write_LoginTokenå’Œreq.bodyä¸­çš„usernameä¾†ç”Ÿæˆtokenä¸¦å¯«å…¥è³‡æ–™åº«ï¼Œç„¶å¾Œsql.Write_LoginTokençš„å›å‚³çµæœå¦‚æœæˆåŠŸå°±æŠŠçµæœä¸­çš„tokenæ”¾åˆ°ä½¿ç”¨è€…çš„cookieï¼Œç„¶å¾Œä¹ŸæŠŠusernameæ”¾åˆ°ä½¿ç”¨è€…çš„cookieï¼Œç„¶å¾Œres.json({"state":"success"})ã€‚è€Œå…¶ä»–çš„æƒ…æ³ï¼Œå¦‚å¯†ç¢¼éŒ¯èª¤ï¼Œæˆ–æ˜¯å¯«å…¥tokenå¤±æ•—ï¼Œå‰‡res.json({"state":"fail"})

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const post_login_handler = async (req, res) => {
  const { username, hashed_password } = req.body;

  const isValid = await sqldatacenter.Verify_HashedPassword(username, hashed_password);
  if (!isValid) {
    res.json({ state: "fail" });
    return;
  }

  const tokenResult = await sqldatacenter.Write_LoginToken(username);
  if (tokenResult.state === "success") {
    res.cookie("username", username);
    res.cookie("token", tokenResult.token);
    res.json({ state: "success" });
  } else {
    res.json({ state: "fail" });
  }
};


/* ----------------prompt-----Id: filename:./application/index.js|name:get_givePostSuggest_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šget_givePostSuggest_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(req,res)

return éš¨æ„

logic:

å‘¼å«sqldatacenter.updateAndSendGlobalRecommendNumberï¼Œç„¶å¾ŒæŠŠä»–çš„å›å‚³å€¼ç”¨res.json()å‚³åˆ°å‰ç«¯

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const get_givePostSuggest_handler = async (req, res) => {
  const result = await sqldatacenter.updateAndSendGlobalRecommendNumber();
  res.json(result);
};


/* ----------------prompt-----Id: filename:./application/index.js|name:post_logout_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špost_logout_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input (req,res)

return:éš¨æ„ 

logic:
å…ˆå»req.cookieæ‹¿åˆ°usernameå’Œtokenï¼Œè¼¸å…¥sqldatacenter.Verify_LoginTokenåšæª¢æŸ¥ï¼Œæª¢æŸ¥æ­£ç¢ºå¾Œå†ç”¨sqldatacenter.logoutåŠusernameåšç™»å‡ºçš„å‹•ä½œã€‚å¦‚æœä¸€åˆ‡æˆåŠŸç„¶å¾Œsqldatacenter.logoutå›å‚³"success"ï¼Œå°±res.send("success");ã€‚å…¶ä»–æƒ…æ³å‰‡res.send("fail");ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

const post_logout_handler = async (req, res) => {
  const username = req.cookies.username;
  const token = req.cookies.token;

  const isValid = await sqldatacenter.Verify_LoginToken(username, token);
  if (!isValid) {
    res.send("fail");
    return;
  }

  const result = await sqldatacenter.logout(username);
  if (result === "success") {
    res.send("success");
  } else {
    res.send("fail");
  }
};


/* ----------------prompt-----Id: filename:./application/index.js|name:get_register_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šget_register_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - Registerpage.html (server_file) in Registerpage.html
    æè¿°ï¼š
         its is a .html file. I'll write it by myself
  - path (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in path
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(req,res)

logic:

res.sendFile(path.join(__dirname,'Registerpage.html'));

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const get_register_handler = (req, res) => {
  res.sendFile(path.join(__dirname, 'Registerpage.html'));
};


/* ----------------prompt-----Id: filename:./application/index.js|name:get_login_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šget_login_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - Loginpage.html (server_file) in Loginpage.html
    æè¿°ï¼š
         its is a .html file. I'll write it by myself
  - path (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in path
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(req,res)

logic:

res.sendFile(path.join(__dirname,'Loginpage.html'));

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
const get_login_handler = (req, res) => {
  res.sendFile(path.join(__dirname, 'Loginpage.html'));
};


/* ----------------prompt-----Id: filename:./application/index.js|name:post_makepost_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼špost_makepost_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".
  - fs (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in fs
      æè¿°ï¼š
          it is an external module. no need to write it
  - path (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in path
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input: (req,res)

return:éš¨æ„

logic: å…ˆæŠŠreqçš„cookieä¸­çš„usernameå’ŒtokenæŠ“å‡ºä¾†ï¼Œç„¶å¾Œåˆ©ç”¨sqldatacenter.Verify_LoginTokenä¾†åšç¢ºèªã€‚å¦‚æœèº«åˆ†é©—è­‰æ­£ç¢ºï¼Œé‚£åˆ©ç”¨sqldatacenter.searchuserIDbyusernameuser_idä¾†æ‰¾åˆ°user_idï¼Œä»¥åŠç”¨ç•¶ä¸‹æ™‚é–“ç”Ÿæˆä¸€å€‹timestampï¼Œä¸€èµ·é€å¾€sqldatacenter.generatePostIdç”Ÿæˆpost_idã€‚é—œæ–¼è²¼æ–‡çš„åœ–ç‰‡å‘¢ï¼Œä»–æ˜¯åœ¨req.file,è¦æŠŠreq.file.bufferå„²å­˜åœ¨åç‚º"/home/ec2-user/postsimages"çš„ç›®éŒ„ä¸‹ï¼Œå‰¯æª”åç”¨path.extname(req.file.originalname)ç„¶å¾Œæª”åç”¨post_idã€‚ç›®éŒ„å¦‚æœä¸å­˜åœ¨éœ€è¦è‡ªå·±ç”Ÿæˆå–”ã€‚å¦‚æœæª”æ¡ˆå¯«å…¥å¤±æ•—ï¼Œå°±çµæŸä¸€åˆ‡ï¼Œres.send("fail")ã€‚å¾req.bodyä¸­å–å‡ºarticleï¼Œä»¥åŠå·²æœ‰çš„usernameå’Œtimestampï¼Œé‚„æœ‰åœ–ç‰‡å­˜æ”¾çš„æª”æ¡ˆè·¯å¾‘ï¼Œä¸€èµ·é€å¾€sqldatacenter.makepostå‡½å¼ã€‚å¦‚æœsqldatacenter.makepostå›å‚³"success"ï¼Œres.send("success")ï¼Œè€Œå…¶é¤˜çš„æƒ…æ³ï¼Œéƒ½ç”¨res.send("fail")ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

const post_makepost_handler = async (req, res) => {
  const username = req.cookies.username;
  const token = req.cookies.token;

  const isValid = await sqldatacenter.Verify_LoginToken(username, token);
  if (!isValid) {
    res.send("fail");
    return;
  }

  const user_id = await sqldatacenter.searchuserIDbyusername(username);
  if (!user_id) {
    res.send("fail");
    return;
  }

  const timestamp = Date.now();
  const post_id = sqldatacenter.generatePostId(timestamp, user_id);

  const imageDir = "/home/ec2-user/postsimages";
  const imageExt = path.extname(req.file.originalname);
  const imagePath = `${imageDir}/${post_id}${imageExt}`;

  try {
    if (!fs.existsSync(imageDir)) {
      fs.mkdirSync(imageDir, { recursive: true });
    }
    fs.writeFileSync(imagePath, req.file.buffer);
  } catch (err) {
    res.send("fail");
    return;
  }

  const result = await sqldatacenter.makepost(
    username,
    imagePath,
    req.body.article,
    timestamp.toString()
  );

  if (result === "success") {
    res.send("success");
  } else {
    res.send("fail");
  }
};


/* ----------------prompt-----Id: filename:./application/index.js|name:get_readPost_handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šget_readPost_handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".
  - fs (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in fs
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(req,res)

return éš¨æ„

logic:å¾req.queryè®€å–post_idï¼Œç„¶å¾Œç”¨sqldatacenterreadPostByPost_idå’Œpost_idä¾†ç²å–ä¸€å€‹jsonç‰©ä»¶ã€‚é€™å€‹jsonç‰©ä»¶æˆ‘å€‘æŠŠä»–å«postObjectå¥½äº†ã€‚å¾é‚£å€‹ç‰©ä»¶çš„imagepathåˆ©ç”¨fsä¾†è®€å–ï¼Œè®€å‡ºä¾†çš„æ±è¥¿å«åšimagecontentã€‚åˆ©ç”¨sqldatacenter.searchusernamebyuserID(post_Object.user_id)ä¾†æ‰¾åˆ°ä½œè€…åusernameã€‚å¦‚æœä¸€åˆ‡é †åˆ©ï¼Œ
res.json({"imagecontent":imagecontent,"article":post_Object.article,"created_at":post_Object.created_at,"like_count":post_Object.like_count,"author":username})ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>

const get_readPost_handler = async (req, res) => {
  const post_id = req.query.post_id;
  if (!post_id) {
    res.json({ error: "missing post_id" });
    return;
  }

  const postObject = await sqldatacenter.readPostByPost_id(post_id);
  if (!postObject) {
    res.json({ error: "post not found" });
    return;
  }

  let imagecontent;
  try {
    imagecontent = fs.readFileSync(postObject.imagepath, { encoding: "base64" });
  } catch (e) {
    res.json({ error: "image not found" });
    return;
  }

  const username = await sqldatacenter.searchusernamebyuserID(postObject.user_id);
  if (!username) {
    res.json({ error: "author not found" });
    return;
  }

  res.json({
    imagecontent: imagecontent,
    article: postObject.article,
    created_at: postObject.created_at,
    like_count: postObject.like_count,
    author: username
  });
};

/* ----------------prompt-----Id: filename:./application/index.js|name:get__handler|placeType:server|type:EndpointHandler---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼šget__handler
é¡å‹ï¼šEndpointHandler
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - sqldatacenter (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from sqldatacenter (GlobalVariable) in ./application/sqldatacenter.js
      æè¿°ï¼š
          let it own what it should own
      - own pool (GlobalVariable) in ./application/sqldatacenter.js
        æè¿°ï¼š
           const pool = mysql.createPool({
               host: 'testmysql-1.crseg8qams8s.ap-southeast-2.rds.amazonaws.com',
               user: sqlusername,
               password: sqlpassword,
               database: 'testdatabase',
               waitForConnections: true,
               connectionLimit: 10,
               queueLimit: 0
           }).promise();
      - own readPostByPost_id (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(post_id)
           
           return: ([type:json])
           
           function type: it is async
           
           logic:
           å‰å¾€æ‰€æåŠçš„è³‡æ–™åº«tableæœå°‹è©²post_idå°æ‡‰çš„æ‰€æœ‰æ¬„ä½å…§å®¹ï¼Œç„¶å¾Œè¿”å›ä»–ã€‚è‹¥æ²’æ±è¥¿å°±è¿”å›null
      - own sendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥æœ‰ï¼Œç›´æ¥return "alreadyExist"ï¼›è‹¥ç„¡ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own unsendlike (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int],post_id [type:int])
           
           return: ( a string [type:string])
           
           
           function type: it is async
           
           logic:
           å…ˆæª¢æŸ¥å»userlikesinfoæª¢æŸ¥é€™å€‹user_idæ˜¯ä¸æ˜¯å·²ç¶“å°æ­¤post_idæŒ‰è®šäº†ã€‚è‹¥ç„¡ï¼Œç›´æ¥return "neverï¼¬ikeBefore"ï¼›è‹¥æœ‰ï¼Œuserlikesinfoæ’å…¥ä¸€å€‹é€™å€‹likeï¼Œç„¶å¾Œå†å»userpostsinfoæ ¹æ“šuserlikesinfoå…§å®¹æ›´æ–°userpostsinfoä¸­çš„è©²post_idçš„è®šæ•¸ï¼ˆé€™å€‹æ­¥é©Ÿä¸­ï¼ŒæˆåŠŸå°±return "success"ï¼Œ å¤±æ•—å°±return "fail"ï¼‰ã€‚
      - own updateAndSendGlobalRecommendNumber (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: no input
           
           return: a json arrayï¼Œæ¯å€‹elementæ˜¯æœ‰post_id,globalrecommendscore,user_idé€™ä¸‰å€‹keyçš„jsonï¼Œpost_idå°æ‡‰åˆ°stringï¼Œè€Œ
           globalrecommendscoreå’Œuser_idå°æ‡‰åˆ°intã€‚
           
           
           function type: it is async
           
           
           logic:
           
           å…ˆå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id, like_count, secondTimeæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚éæ­·é€™å€‹é™£åˆ—ï¼Œè¨ˆç®—å‡ºå…ƒç´ çš„timeSincePosted=Date.now()-element.secondTime;ã€‚æŠŠå…ƒç´ çš„like_counté‚„æœ‰timeSincePostedäº¤çµ¦GlobalRecommendNumberCalculatorè¨ˆç®—åˆ†æ•¸ï¼ŒæŠŠé€™å€‹åˆ†æ•¸å­˜åˆ°userpostsinfoä¸­è©²å…ƒç´ çš„post_idçš„globalrecommendscoreæ¬„ä½ã€‚
           
           æœ€å¾Œï¼Œå»userpostsinfoæŠŠæ‰€æœ‰is_deleted=FALSEçš„è³‡æ–™çš„post_id,globalrecommendscore,user_idæŠ“ä¸‹ä¾†ï¼Œé€™æ¨£æœƒå¾—åˆ°ä¸€å€‹é™£åˆ—ã€‚returné€™å€‹é™£åˆ—ã€‚
      - own searchlike_count (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [Type:int ])
           
           function type: it is async
           
           return (a number or null [type:int])
           logic:
           å…ˆæª¢æŸ¥inputæ˜¯å¦ç‚ºç©ºã€‚å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„like_countï¼Œè‹¥æ‰¾ä¸åˆ°å‰‡è¿”å›nullã€‚
      - own makepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [type string],imagepath [type:string],article [type:string],secondTime [type:string]);
           
           return: (a string [type:string])
           
           
           logic:
           do things as below. if they all succeed,then return "success";otherwise, return "false".
           
                const userID=await searchuserIDbyusername(username);
                await Appenduserpostsinfo(secondTime,userID);
                const post_id=generatePostId(secondTime,userID);
                await modifyuserpostsinfo(post_id,secondTime,article,imagepath);
           		
                await modifyuserpostsinfouserID(userID,post_id);
      - own diduserlikepost (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_id [type:int ],post_id [type:int])
           
           return: (a boolean [Type:boolean])
           
           logic: 
           å‰å¾€userlikesinfoæŸ¥è©¢æœ‰ç„¡æ¬„ä½ost_idå’Œæ¬„ä½user_idéƒ½ç¬¦åˆå‡½æ•¸è¼¸å…¥çš„è³‡æ–™ï¼Œæœ‰å°±return trueï¼Œå¤±æ•—æˆ–æ²’æœ‰å°±å‚³return false
      - own Appenduserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (timestamp [Type:int],userID [Type:int])
           
           return: (a string [type:string])
           
           logic:
           
           å…ˆç”¨generatePostId(timestamp,userID)è¨ˆç®—å‡ºpost_idï¼Œç„¶å¾ŒæŠŠ(post_id, user_id)æ’å…¥userpostsinfoã€‚æ’å…¥æˆåŠŸè¦return "success", å¤±æ•—å°±return "fail"
      - own modifyuserpostsinfo (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (post_id [type:int],secondTime [type:int],article[type:int],imagepath[type:int])
           
           return: (a string [type:string])
           
           
           logic:
           å»userpostsinfoæ‰¾åˆ°è©²post_idå°æ‡‰åˆ°çš„æ¬„ä½ï¼ŒæŠŠsecondTime,article,imagepathè¨­ç‚ºå‡½æ•¸è¼¸å…¥å€¼ï¼Œè€Œcreated_atè¨­ç‚ºFROM_UNIXTIME(?)ã€‚
           å¦‚æœæ‰¾ä¸åˆ°ï¼Œæˆ–æ˜¯åŸ·è¡Œå¤±æ•—ï¼Œreturn "fail"ï¼Œä¸€åˆ‡æˆåŠŸçš„è©±return "success"ã€‚
      - own searchuserIDbyusername (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: int or null
           
           logic:
           å»userinfoæŸ¥è©¢usernameæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„userIDã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own searchusernamebyuserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (userID [type:int])
           
           return: string or null
           
           logic:
           å»userinfoæŸ¥è©¢userIDæ¬„ä½å’Œè¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œè¿”å›é‚£é …è³‡æ–™çš„usernameã€‚æ‰¾ä¸åˆ°æˆ–å¤±æ•—å‰‡è¿”å›nullã€‚
      - own checkuserexists (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string])
           
           return: boolean
           
           logic:
           å»userinfoæŸ¥è©¢æœ‰ç„¡usernameæ¬„ä½å’Œå‡½æ•¸è¼¸å…¥ä¸€æ¨£çš„è³‡æ–™ï¼Œæœ‰æˆ–æŸ¥è©¢å¤±æ•—å‰‡return trueï¼Œç„¡å‰‡return false
      - own modifyuserpostsinfouserID (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (user_ID [Type:int],post_id [Type:int])
           
           function type: it is async
           
           return: (a string [type:string])
           logic: å»userpostsinfoæ‰¾åˆ°post_idå°æ‡‰çš„user_IDï¼Œç„¶å¾ŒæŠŠuser_IDæ¬„æ”¹æˆå‡½æ•¸è¼¸å…¥å€¼ã€‚å¦‚æœå¤±æ•—æˆ–æ‰¾ä¸åˆ°å°æ‡‰ï¼Œå›å‚³"fail";æˆåŠŸå°±å›å‚³"success"ã€‚
      - own Verify_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string],token [Type: string])
           
           return (true or false [Type:boolean])
           
           function type: it is async
           
           Logic:
           å‰å¾€userLoginTokençš„å°æ‡‰usernameæ¬„ä½ï¼Œçœ‹çœ‹è³‡æ–™åº«çš„tokenå’Œå‡½å¼è¼¸å…¥çš„tokenæ˜¯å¦ç›¸åŒã€‚ç›¸åŒå°±è¿”å›trueï¼Œä¸ç›¸åŒå°±è¿”å›false
      - own Write_LoginToken (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(username [Type: string])
           
           return : ( a json that contains state and token. state and token are string[Type: json])
           
           function type: it is async
           
           Logic:
           åœ¨æœ¬å‡½å¼ï¼Œé‹ç”¨jwtï¼Œé‚„æœ‰ç³»çµ±æ™‚é–“ã€usernameï¼Œç”Ÿæˆä¸€å€‹ç°½ç« ï¼ŒæŠŠè©²ç°½ç« å­˜å…¥userLoginTokenè©²tableä¸­å°æ‡‰åˆ°å‡½å¼è¼¸å…¥çš„usernameçš„é‚£æ¬„ï¼ˆå¦‚æœæ²’æœ‰æ¬„ä½å°±å‰µé€ ä¸€å€‹ï¼‰ã€‚ç„¶å¾ŒæˆåŠŸå°±åœ¨ï½’ï½…ï½”ï½•ï½’ï½çš„é‚£å€‹jsonçš„stateå¡«"success"ï¼Œtokenå¡«å‰›å‰›çš„signatureï¼›å¤±æ•—å‰‡stateå¡«"fail"ï¼Œtokenå¡«"".
      - own generatePostId (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input:(timestamp [Type: int],userId [Type: int])
           
           return: (a big INT number [Type: BigInt])
           
           Logic:
           è¼¸å‡ºçš„æ•¸å­—æœ«åä½æ”¾userIdï¼ŒuserIdå‰é¢æ”¾timestamp
      - own Write_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           since i don't need it now, just write it as am empty function
      - own Verify_HashedPassword (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: boolean
           
           logic:
           ç›´æ¥å»userHashedPasswordæ¯”å°æ˜¯å¦å»åˆã€‚å»åˆå‚³trueï¼Œä¸å»åˆå‚³false.
      - own Create_UserAccount (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input: (username [type:string],hashedpassword [type:string])
           
           return: a string 
           
           logic:
           mysqlè³‡æ–™åº«çš„å¯«å…¥ä½¿ç”¨transaction. æ’å…¥inputçš„ç›¸é—œè³‡æ–™åˆ°userHashedPasswordã€userinfoã€userLoginTokenã€‚å¦‚æœä¸€åˆ‡éƒ½æˆåŠŸï¼Œå›å‚³"success"ï¼Œåä¹‹ï¼Œå›å‚³"fail".
      - own logout (Function) in ./application/sqldatacenter.js
        æè¿°ï¼š
           input :(username [type:string])
           
           
           return : (a string [type: string])
           
           logic:
           
           å‰å¾€userLoginTokenï¼ŒæŠŠå°æ‡‰åˆ°inputçš„usernameå°æ‡‰åˆ°çš„æ¬„ä½tokenå€¼æ”¹æˆnull.å¦‚æœæ‰¾ä¸åˆ°é€™å€‹æ¬„ä½ï¼Œæˆ–æ˜¯éç¨‹å¤±æ•—ï¼Œreturn "fail"ï¼ŒæˆåŠŸå‰‡return "success".
  - returnMainpage (Function) in ./application/index.js
    æè¿°ï¼š
         just import it
    - import from returnMainpage (Function) in ./application/returnMainpage.js
      æè¿°ï¼š
          input (username [type:string])
  - ./application/NotloginMainpage.html (server_file) in ./application/NotloginMainpage.html
    æè¿°ï¼š
         I should do this component by myself
  - path (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         just import the module
    - import from module (GlobalVariable) in path
      æè¿°ï¼š
          it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
input:(req,res)

return éš¨æ„

logic:

æª¢æŸ¥reqä¸­çš„cookieï¼Œå¦‚æœæœ‰usernameå’ŒTokenï¼Œå°±é€å»çµ¦sqldatacenterä¸­çš„Verify_LoginTokené©—è­‰ï¼Œå¦‚æœæˆåŠŸå°±é‹ç”¨returnMainpageåŠusernameä¾†ç²å–è¦å‚³é€çµ¦å‰ç«¯çš„htmlç¨‹å¼ç¢¼ï¼Œç”¨res.sendå‚³åˆ°å‰ç«¯ã€‚å…¶ä»–æƒ…æ³å‰‡æ˜¯ç”¨res.sendFileä»¥åŠpath,__dirnameä¾†è®€å–ä¸¦é€å‡ºNotloginMainpage.html

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

const get__handler = async (req, res) => {
  const username = req.cookies.username;
  const token = req.cookies.token;

  if (username && token) {
    const isValid = await sqldatacenter.Verify_LoginToken(username, token);
    if (isValid) {
      const html = returnMainpage(username);
      res.send(html);
      return;
    }
  }

  res.sendFile(path.join(__dirname, 'NotloginMainpage.html'));
};


/* ----------------prompt-----Id: filename:./application/index.js|name:/sendlike|placeType:server|type:APIEndpoint[POST]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/sendlike
é¡å‹ï¼šAPIEndpoint[POST]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - post_sendlike_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input: (req,res)
         
         return:éš¨æ„
         
         logic: å…ˆæŠŠreqçš„cookieä¸­çš„usernameå’ŒtokenæŠ“å‡ºä¾†ï¼Œç„¶å¾Œåˆ©ç”¨sqldatacenter.Verify_LoginTokenä¾†åšç¢ºèªã€‚å¦‚æœèº«åˆ†é©—è­‰æ­£ç¢ºï¼Œé‚£å°±æŠ“å‡ºreq.bodyä¸­çš„user_idå’Œpost_idä¾†åŸ·è¡Œsqldatacenter.sendlikeã€‚å¦‚æœä¸€åˆ‡æˆåŠŸï¼Œå°±res.send({"state":"success"})ã€‚å¦‚æœéç¨‹ä¸­æœ‰ä»»ä½•å¤±æ•—ï¼Œä¾‹å¦‚èº«åˆ†é©—è­‰å¤±æ•—ï¼Œå°±res.send({"state":"fail"})ã€‚
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.post('/sendlike',post_sendlike_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.post('/sendlike', post_sendlike_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/unsendlike|placeType:server|type:APIEndpoint[POST]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/unsendlike
é¡å‹ï¼šAPIEndpoint[POST]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - post_unsendlike_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input: (req,res)
         
         return:éš¨æ„
         
         logic: å…ˆæŠŠreqçš„cookieä¸­çš„usernameå’ŒtokenæŠ“å‡ºä¾†ï¼Œç„¶å¾Œåˆ©ç”¨sqldatacenter.Verify_LoginTokenä¾†åšç¢ºèªã€‚å¦‚æœèº«åˆ†é©—è­‰æ­£ç¢ºï¼Œé‚£å°±æŠ“å‡ºreq.bodyä¸­çš„user_idå’Œpost_idä¾†åŸ·è¡Œsqldatacenter.unsendlikeã€‚å¦‚æœä¸€åˆ‡æˆåŠŸï¼Œå°±res.send({"state":"success"})ã€‚å¦‚æœéç¨‹ä¸­æœ‰ä»»ä½•å¤±æ•—ï¼Œä¾‹å¦‚èº«åˆ†é©—è­‰å¤±æ•—ï¼Œå°±res.send({"state":"fail"})ã€‚
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.post('/unsendlike',post_unsendlike_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

app.post('/unsendlike', post_unsendlike_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/register|placeType:server|type:APIEndpoint[POST]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/register
é¡å‹ï¼šAPIEndpoint[POST]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - post_register_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input (req,res)
         
         return:éš¨æ„
         
         logic:
         å…ˆå»req.bodyæ‹¿å‡ºrequestedUsernameå’ŒrequestedHashed_Passwordã€‚ä½¿ç”¨sqldatacenter.checkuserexistsä¾†æŸ¥è©¢requestedUsernameé€™å€‹åç¨±æ˜¯å¦å·²è¢«è¨»å†Šã€‚å¦‚æœæ˜¯ï¼Œres.send("thisUsernameAlreadyExist")ã€‚å¦‚æœä¸æ˜¯ï¼Œä½¿ç”¨Create_UserAccountæŠŠrequestedUsernameå’ŒrequestedHashed_Passwordå¡«å…¥ï¼Œå¦‚æœä»–å›å‚³"success"ï¼Œå°±res.send("success")ï¼Œå¦‚æœå›å‚³"fail"ï¼Œå°±res.send("fail")ã€‚
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.post('/register',post_register_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.post('/register', post_register_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/login|placeType:server|type:APIEndpoint[POST]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/login
é¡å‹ï¼šAPIEndpoint[POST]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - post_login_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input (req,res)
         
         return:éš¨æ„
         
         logic
         å°‡req.bodyä¸­çš„usernameå’Œhashed_passwordäº¤çµ¦sqldatacenter.Verify_HashedPasswordä¾†æª¢æŸ¥æ˜¯å¦æ­£ç¢ºï¼Œæ­£ç¢ºçš„è©±å°±sql.Write_LoginTokenå’Œreq.bodyä¸­çš„usernameä¾†ç”Ÿæˆtokenä¸¦å¯«å…¥è³‡æ–™åº«ï¼Œç„¶å¾Œsql.Write_LoginTokençš„å›å‚³çµæœå¦‚æœæˆåŠŸå°±æŠŠçµæœä¸­çš„tokenæ”¾åˆ°ä½¿ç”¨è€…çš„cookieï¼Œç„¶å¾Œä¹ŸæŠŠusernameæ”¾åˆ°ä½¿ç”¨è€…çš„cookieï¼Œç„¶å¾Œres.json({"state":"success"})ã€‚è€Œå…¶ä»–çš„æƒ…æ³ï¼Œå¦‚å¯†ç¢¼éŒ¯èª¤ï¼Œæˆ–æ˜¯å¯«å…¥tokenå¤±æ•—ï¼Œå‰‡res.json({"state":"fail"})
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.post('/login',post_login_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

app.post('/login', post_login_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/givePostSuggest|placeType:server|type:APIEndpoint[GET]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/givePostSuggest
é¡å‹ï¼šAPIEndpoint[GET]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - get_givePostSuggest_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input:(req,res)
         
         return éš¨æ„
         
         logic:
         
         å‘¼å«sqldatacenter.updateAndSendGlobalRecommendNumberï¼Œç„¶å¾ŒæŠŠä»–çš„å›å‚³å€¼ç”¨res.json()å‚³åˆ°å‰ç«¯
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.get('/givePostSuggest',get_givePostSuggest_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.get('/givePostSuggest', get_givePostSuggest_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/logout|placeType:server|type:APIEndpoint[POST]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/logout
é¡å‹ï¼šAPIEndpoint[POST]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - post_logout_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input (req,res)
         
         return:éš¨æ„ 
         
         logic:
         å…ˆå»req.cookieæ‹¿åˆ°usernameå’Œtokenï¼Œè¼¸å…¥sqldatacenter.Verify_LoginTokenåšæª¢æŸ¥ï¼Œæª¢æŸ¥æ­£ç¢ºå¾Œå†ç”¨sqldatacenter.logoutåŠusernameåšç™»å‡ºçš„å‹•ä½œã€‚å¦‚æœä¸€åˆ‡æˆåŠŸç„¶å¾Œsqldatacenter.logoutå›å‚³"success"ï¼Œå°±res.send("success");ã€‚å…¶ä»–æƒ…æ³å‰‡res.send("fail");ã€‚


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.post('/logout',post_logout_handler);

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.post('/logout', post_logout_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/register|placeType:server|type:APIEndpoint[GET]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/register
é¡å‹ï¼šAPIEndpoint[GET]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - get_register_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input:(req,res)
         
         logic:
         
         res.sendFile(path.join(__dirname,'Registerpage.html'));
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.get('/register',get_register_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.get('/register', get_register_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/login|placeType:server|type:APIEndpoint[GET]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/login
é¡å‹ï¼šAPIEndpoint[GET]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - get_login_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input:(req,res)
         
         logic:
         
         res.sendFile(path.join(__dirname,'Loginpage.html'));
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.get('/login',get_login_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/

app.get('/login', get_login_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/makepost|placeType:server|type:APIEndpoint[POST]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/makepost
é¡å‹ï¼šAPIEndpoint[POST]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - post_makepost_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input: (req,res)
         
         return:éš¨æ„
         
         logic: å…ˆæŠŠreqçš„cookieä¸­çš„usernameå’ŒtokenæŠ“å‡ºä¾†ï¼Œç„¶å¾Œåˆ©ç”¨sqldatacenter.Verify_LoginTokenä¾†åšç¢ºèªã€‚å¦‚æœèº«åˆ†é©—è­‰æ­£ç¢ºï¼Œé‚£åˆ©ç”¨sqldatacenter.searchuserIDbyusernameuser_idä¾†æ‰¾åˆ°user_idï¼Œä»¥åŠç”¨ç•¶ä¸‹æ™‚é–“ç”Ÿæˆä¸€å€‹timestampï¼Œä¸€èµ·é€å¾€sqldatacenter.generatePostIdç”Ÿæˆpost_idã€‚é—œæ–¼è²¼æ–‡çš„åœ–ç‰‡å‘¢ï¼Œä»–æ˜¯åœ¨req.file,è¦æŠŠreq.file.bufferå„²å­˜åœ¨åç‚º"/home/ec2-user/postsimages"çš„ç›®éŒ„ä¸‹ï¼Œå‰¯æª”åç”¨path.extname(req.file.originalname)ç„¶å¾Œæª”åç”¨post_idã€‚ç›®éŒ„å¦‚æœä¸å­˜åœ¨éœ€è¦è‡ªå·±ç”Ÿæˆå–”ã€‚å¦‚æœæª”æ¡ˆå¯«å…¥å¤±æ•—ï¼Œå°±çµæŸä¸€åˆ‡ï¼Œres.send("fail")ã€‚å¾req.bodyä¸­å–å‡ºarticleï¼Œä»¥åŠå·²æœ‰çš„usernameå’Œtimestampï¼Œé‚„æœ‰åœ–ç‰‡å­˜æ”¾çš„æª”æ¡ˆè·¯å¾‘ï¼Œä¸€èµ·é€å¾€sqldatacenter.makepostå‡½å¼ã€‚å¦‚æœsqldatacenter.makepostå›å‚³"success"ï¼Œres.send("success")ï¼Œè€Œå…¶é¤˜çš„æƒ…æ³ï¼Œéƒ½ç”¨res.send("fail")ã€‚
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.post('/makepost',upload.single("imagefile"),post_makepost_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.post('/makepost', upload.single("imagefile"), post_makepost_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/readPost|placeType:server|type:APIEndpoint[GET]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/readPost
é¡å‹ï¼šAPIEndpoint[GET]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - get_readPost_handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input:(req,res)
         
         return éš¨æ„
         
         logic:å¾req.queryè®€å–post_idï¼Œç„¶å¾Œç”¨sqldatacenterreadPostByPost_idå’Œpost_idä¾†ç²å–ä¸€å€‹jsonç‰©ä»¶ã€‚é€™å€‹jsonç‰©ä»¶æˆ‘å€‘æŠŠä»–å«postObjectå¥½äº†ã€‚å¾é‚£å€‹ç‰©ä»¶çš„imagepathåˆ©ç”¨fsä¾†è®€å–ï¼Œè®€å‡ºä¾†çš„æ±è¥¿å«åšimagecontentã€‚åˆ©ç”¨sqldatacenter.searchusernamebyuserID(post_Object.user_id)ä¾†æ‰¾åˆ°ä½œè€…åusernameã€‚å¦‚æœä¸€åˆ‡é †åˆ©ï¼Œ
         res.json({"imagecontent":imagecontent,"article":post_Object.article,"created_at":post_Object.created_at,"like_count":post_Object.like_count,"author":username})ã€‚
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.get('/readPost',get_readPost_handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.get('/readPost', get_readPost_handler);


/* ----------------prompt-----Id: filename:./application/index.js|name:/|placeType:server|type:APIEndpoint[GET]---------------- */
/*
<START>

å…ƒä»¶åç¨±ï¼š/
é¡å‹ï¼šAPIEndpoint[GET]
æª”æ¡ˆï¼š./application/index.js
ä½ å”¯ä¸€å¯ä»¥ä½¿ç”¨çš„å¤–éƒ¨ç‰©ä»¶(åŒ…å«å‡½å¼)åœ¨é€™è£¡çš„ç¬¬ä¸€å±¤ï¼Œæ›´æ·±çš„å±¤çš„å…ƒä»¶åŠå…¶æè¿°åªæ˜¯èªªæ˜ç”¨(èªªæ˜importè‡ªå“ªè£¡æˆ–æ˜¯æ“æœ‰ç”šéº¼)ï¼Œä¸èƒ½ç”¨ã€‚æ³¨æ„å–”ï¼Œä¸è¦ä½¿ç”¨é€™é‚Šä»¥å¤–çš„å…¨åŸŸè®Šæ•¸æˆ–æ˜¯å­˜å–å…¶ä»–ç‰©ä»¶(ex.table)ï¼š
  - get__handler (EndpointHandler) in ./application/index.js
    æè¿°ï¼š
         input:(req,res)
         
         return éš¨æ„
         
         logic:
         
         æª¢æŸ¥reqä¸­çš„cookieï¼Œå¦‚æœæœ‰usernameå’ŒTokenï¼Œå°±é€å»çµ¦sqldatacenterä¸­çš„Verify_LoginTokené©—è­‰ï¼Œå¦‚æœæˆåŠŸå°±é‹ç”¨returnMainpageåŠusernameä¾†ç²å–è¦å‚³é€çµ¦å‰ç«¯çš„htmlç¨‹å¼ç¢¼ï¼Œç”¨res.sendå‚³åˆ°å‰ç«¯ã€‚å…¶ä»–æƒ…æ³å‰‡æ˜¯ç”¨res.sendFileä»¥åŠpath,__dirnameä¾†è®€å–ä¸¦é€å‡ºNotloginMainpage.html
  - app (GlobalVariable) in ./application/index.js
    æè¿°ï¼š
         it is an external module. no need to write it


ç¾åœ¨è¦å¯«çš„å…ƒä»¶çš„æè¿°ï¼š
app.get('/',get__handler);
é€™æ¨£å¯«å°±å¥½ã€‚

è«‹æ ¹æ“šä»¥ä¸Šè³‡è¨Šç”Ÿæˆæ­¤å…ƒä»¶çš„åŠŸèƒ½ç¨‹å¼ç¢¼(javascript)ã€‚å°±åªç”Ÿæˆé€™å€‹å…ƒä»¶å–”ï¼Œä¸è¦å¹«å¿™åšexportç”šéº¼çš„ï¼Œæˆ–æ˜¯è‡ªå·±å¼•å…¥å…¶ä»–å…¨åŸŸè®Šæ•¸ã€‚é€™å€‹è»Ÿé«”ç³»çµ±çš„é è¨­èƒŒæ™¯æ˜¯node.jsã€expressã€mysql

<END>
*/
app.get('/', get__handler);
